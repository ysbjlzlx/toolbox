import{af as l,al as N,ah as b,ap as P,ai as z,aq as E,ar as k,as as A}from"./pro-components-L2sDkqQs.js";import{c as v}from"./colors-CHqU5QMp.js";import{a as n,ad as S,D,B as R,a6 as y,bw as H,a9 as F,Y as q}from"./antd-Bzy0GL_f.js";import{d as T}from"./md-editor-C6otpRZL.js";import{v as j}from"./json-editor-CBqK5HSN.js";import"./ace-BbTluGSE.js";const C=({children:t})=>l.jsx("div",{className:"flex w-full justify-center",children:t}),w=()=>({width:150,height:150,suffix:".png",bgColor:"#cccccc",textColor:"#969696",text:""}),$=t=>{const o=w();return t.width&&t.width>0&&(o.width=t.width),t.height&&t.height>0&&(o.height=t.height),t.suffix&&(o.suffix=t.suffix),t.bgColor&&(o.bgColor=t.bgColor),t.textColor&&(o.textColor=t.textColor),t.text&&t.text!==""&&(o.text=t.text),o},M=t=>{const[o,c]=n.useState(""),[e,a]=n.useState(w());return n.useEffect(()=>{a($(t))},[t]),n.useEffect(()=>{var r,i;const s=`https://dummyimage.com/${e.width}x${e.height}/${(r=e.bgColor)==null?void 0:r.substring(1)}/${(i=e.textColor)==null?void 0:i.substring(1)}?text=${encodeURIComponent(e.text||"img")}`;c(s)},[e]),l.jsx(C,{children:l.jsx(S,{src:o,style:{width:`${e.width}px`,height:`${e.height}px`},alt:e.text||"placeholder img"})})},V=t=>{const[o,c]=n.useState(""),[e,a]=n.useState(w());return n.useEffect(()=>{a($(t))},[t]),n.useEffect(()=>{var r,i;const s=`https://iph.href.lu/${e.width}x${e.height}?bg=${(r=e.bgColor)==null?void 0:r.substring(1)}&fg=${(i=e.textColor)==null?void 0:i.substring(1)}&text=${encodeURIComponent(e.text||"img")}`;c(s)},[e]),l.jsx(C,{children:l.jsx(S,{preview:!1,src:o,width:e.width,height:e.height,style:{width:`${e.width}px`,height:`${e.height}px`},alt:e.text||"placeholder img"})})};var p,U;function W(){if(U)return p;U=1;function t(e,a){const s=window.getComputedStyle(e);for(const r of s)a.style[r]=s[r];for(let r=0;r<e.children.length;r++)t(e.children[r],a.children[r])}function o({source:e,target:a,scale:s,format:r,quality:i}){let h=new XMLSerializer().serializeToString(a),d=document.createElement("canvas"),m=e.getBoundingClientRect();d.width=m.width*s,d.height=m.height*s,d.style.width=m.width,d.style.height=m.height;let f=d.getContext("2d");f.scale(s,s);let g=document.createElement("img");return g.setAttribute("src","data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(h)))),new Promise(x=>{g.onload=()=>{f.drawImage(g,0,0),x(d.toDataURL(`image/${r==="jpg"?"jpeg":r}`,i))}})}function c({file:e,name:a,format:s}){let r=document.createElement("a");r.download=`${a}.${s}`,r.href=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}return p=async function(e,a,{scale:s=1,format:r="png",quality:i=.92,download:h=!0,ignore:d=null,cssinline:m=1,background:f=null}={}){e=e instanceof Element?e:document.querySelector(e);const g=document.createElementNS("http://www.w3.org/2000/svg","svg");g.innerHTML=e.innerHTML;for(const u of e.attributes)g.setAttribute(u.name,u.value);if(m===1&&t(e,g),f&&(g.style.background=f),d!=null){const u=g.querySelectorAll(d);[].forEach.call(u,I=>I.parentNode.removeChild(I))}const x=await o({source:e,target:g,scale:s,format:r,quality:i});return h&&c({file:x,name:a,format:r}),x},p}var B=W();const _=D(B),K=t=>{const o=n.useRef(null);n.useEffect(()=>{var e;if(o!=null&&o.current){T(o.current).select("svg").remove();const a=T(o.current).append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1").attr("width",t.width).attr("height",t.height).attr("role","img").style("display","block"),s=a.append("g");s.append("title").text("Layer 1"),s.append("rect").attr("height",t.height).attr("width",t.width).attr("fill",t.bgColor).attr("id","svg_2"),s.append("text").attr("text-anchor","middle").attr("fill",t.textColor).attr("x",t.width/2).attr("y",t.height/2).attr("dominant-baseline","middle").attr("id","svg_3").attr("stroke-width","0").attr("font-size","24").attr("font-family","-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'").text(t.text),console.log((e=a.node())==null?void 0:e.outerHTML)}},[t.bgColor,t.height,t.text,t.textColor,t.width]);const c=()=>{o!=null&&o.current&&_(o.current,`${t.text}-${t.width}x${t.height}`,{quality:1,background:"white"}).then(e=>{console.log(e)})};return l.jsxs("div",{children:[l.jsx("div",{children:l.jsx(R,{type:"primary",onClick:c,children:"下载"})}),l.jsx("div",{className:"m-4",children:l.jsx(C,{children:l.jsx("div",{ref:o,style:{display:"inline-block"}})})})]})},G=t=>{const[o,c]=n.useState(""),[e,a]=n.useState(w());return n.useEffect(()=>{a($(t))},[t]),n.useEffect(()=>{var r,i;const s=`https://via.placeholder.com/${e.width}x${e.height}/${(r=e.bgColor)==null?void 0:r.substring(1)}/${(i=e.textColor)==null?void 0:i.substring(1)}?text=${encodeURIComponent(e.text||"img")}${e.suffix}`;c(s)},[e]),l.jsx(C,{children:l.jsx(S,{src:o,style:{width:`${e.width}px`,height:`${e.height}px`},alt:e.text||"placeholder img"})})},L={width:480,height:320,suffix:".png",bgColor:"#083344",textColor:"#9CA3AF",text:"Placeholder"},O=[{label:".png",value:".png"},{label:".jpg",value:".jpg"},{label:".gif",value:".gif"}],te=()=>{const[t]=y.useForm(),[o,c]=n.useState(L),e=y.useWatch("bgColor",{form:t,preserve:!0}),a=y.useWatch("textColor",{form:t,preserve:!0});n.useEffect(()=>{const i=t.getFieldsValue();c({...i,bgColor:e,textColor:a})},[e,t,a]);const s=n.useMemo(()=>[{label:"Gray",colors:j(v.gray)},{label:"Cyan",colors:j(v.cyan)},{label:"Red",colors:j(v.red)}],[]),r={defaultActiveKey:"LocalImage",items:[{key:"LocalImage",label:"Local",children:l.jsx(K,{...o})},{key:"HrefLuImage",label:"iph.href.lu",children:l.jsx(V,{...o})},{key:"PlaceholderImage",label:"via.placeholder.com",children:l.jsx(G,{...o})},{key:"DummyImage",label:"dummyimage.com",children:l.jsx(M,{...o})}]};return l.jsx(N,{title:!1,className:"mx-auto max-w-screen-lg p-4",children:l.jsxs(H,{children:[l.jsx(b,{submitter:!1,form:t,initialValues:L,onValuesChange:(i,h)=>{c(h)},children:l.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:[l.jsx(P,{label:"宽度",name:"width",fieldProps:{size:"large"}}),l.jsx(P,{label:"高度",name:"height",fieldProps:{size:"large"}}),l.jsx(z,{label:"后缀名",name:"suffix",options:O,allowClear:!1,fieldProps:{size:"large"}}),l.jsx(b.Item,{label:"背景颜色",name:"bgColor",children:l.jsx(E,{children:i=>l.jsx(F,{size:"large",showText:!0,disabledAlpha:!0,className:"w-full justify-start",...k(i),onChange:h=>{t.setFieldValue("bgColor",h.toHexString())},presets:s})})}),l.jsx(b.Item,{label:"文本颜色",name:"textColor",children:l.jsx(E,{children:i=>l.jsx(F,{size:"large",showText:!0,disabledAlpha:!0,className:"w-full justify-start",...k(i),onChange:h=>{t.setFieldValue("textColor",h.toHexString())},presets:s})})}),l.jsx(A,{label:"文本",name:"text",allowClear:!0,fieldProps:{size:"large"}})]})}),l.jsx("div",{children:l.jsx(q,{...r})})]})})};export{te as Component};
