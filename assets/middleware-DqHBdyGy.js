import{R as _}from"./antd-Bzy0GL_f.js";const H=r=>{let s;const t=new Set,o=(i,S)=>{const g=typeof i=="function"?i(s):i;if(!Object.is(g,s)){const h=s;s=S??(typeof g!="object"||g===null)?g:Object.assign({},s,g),t.forEach(f=>f(s,h))}},a=()=>s,c={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(t.add(i),()=>t.delete(i))},d=s=r(o,a,c);return c},j=r=>r?H(r):H,w=r=>r;function E(r,s=w){const t=_.useSyncExternalStore(r.subscribe,()=>s(r.getState()),()=>s(r.getInitialState()));return _.useDebugValue(t),t}const O=r=>{const s=j(r),t=o=>E(s,o);return Object.assign(t,s),t},N=r=>r?O(r):O;function x(r,s){let t;try{t=r()}catch{return}return{getItem:a=>{var n;const m=d=>d===null?null:JSON.parse(d,void 0),c=(n=t.getItem(a))!=null?n:null;return c instanceof Promise?c.then(m):m(c)},setItem:(a,n)=>t.setItem(a,JSON.stringify(n,void 0)),removeItem:a=>t.removeItem(a)}}const b=r=>s=>{try{const t=r(s);return t instanceof Promise?t:{then(o){return b(o)(t)},catch(o){return this}}}catch(t){return{then(o){return this},catch(o){return b(o)(t)}}}},F=(r,s)=>(t,o,a)=>{let n={storage:x(()=>localStorage),partialize:e=>e,version:0,merge:(e,v)=>({...v,...e}),...s},m=!1;const c=new Set,d=new Set;let i=n.storage;if(!i)return r((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),t(...e)},o,a);const S=()=>{const e=n.partialize({...o()});return i.setItem(n.name,{state:e,version:n.version})},g=a.setState;a.setState=(e,v)=>{g(e,v),S()};const h=r((...e)=>{t(...e),S()},o,a);a.getInitialState=()=>h;let f;const I=()=>{var e,v;if(!i)return;m=!1,c.forEach(u=>{var l;return u((l=o())!=null?l:h)});const y=((v=n.onRehydrateStorage)==null?void 0:v.call(n,(e=o())!=null?e:h))||void 0;return b(i.getItem.bind(i))(n.name).then(u=>{if(u)if(typeof u.version=="number"&&u.version!==n.version){if(n.migrate){const l=n.migrate(u.state,u.version);return l instanceof Promise?l.then(p=>[!0,p]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,u.state];return[!1,void 0]}).then(u=>{var l;const[p,R]=u;if(f=n.merge(R,(l=o())!=null?l:h),t(f,!0),p)return S()}).then(()=>{y==null||y(f,void 0),f=o(),m=!0,d.forEach(u=>u(f))}).catch(u=>{y==null||y(void 0,u)})};return a.persist={setOptions:e=>{n={...n,...e},e.storage&&(i=e.storage)},clearStorage:()=>{i==null||i.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>I(),hasHydrated:()=>m,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},n.skipHydration||I(),f||h},P=F;export{x as a,N as c,P as p};
