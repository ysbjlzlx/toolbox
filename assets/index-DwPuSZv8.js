const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B3KiKTSt-D_Q87O6c.js","assets/json-editor-CBqK5HSN.js","assets/antd-Bzy0GL_f.js","assets/pro-components-L2sDkqQs.js","assets/index-DuippPAG.js","assets/functions-Bsik6ikd-BaRT4VwH.js","assets/index.es-DsErxJOC.js","assets/hooks-Bj5sJKsH.js","assets/floating-ui.dom-DtR07Cup.js","assets/index-0oxnn2GF.js","assets/index-BI54Kwls.css","assets/index-i1pBeVdL.js","assets/md-editor-C6otpRZL.js","assets/ace-BbTluGSE.js","assets/md-editor-DhkfSmTB.css","assets/index-08JC0wQa.js","assets/index-Cuk7cL-r-D2buIkaX.js","assets/index-DcRgwPLd-P6ihpufO.js","assets/index.es-DhjJIgDZ.js","assets/index.es-DNOfJYMK.js","assets/index-DKaaQcYk.js","assets/index-BFsG6770-BZqzKW-r.js","assets/index.es-BvjMijTv.js","assets/index-CxJ9fxJm-Cyut1UQw.js","assets/index-DpfRzH2N.js","assets/index-Yr5XBaro-CuXjpj7M.js","assets/index-D6fLMv29-CeGVhQwU.js","assets/index-DOrkOhki-DKJnW9Rn.js","assets/index-COPjfgxB-8VHCRTXW.js","assets/inline-latex-C9IGAXXQ-DRybRJrd.js","assets/index-CBrOT1fW-BEd5UIat.js","assets/index-DO_xaFxN-BEzCla_i.js"])))=>i.map(i=>d[i]);
import{af as ai}from"./pro-components-L2sDkqQs.js";import{a as Xn}from"./antd-Bzy0GL_f.js";import{_ as se}from"./json-editor-CBqK5HSN.js";import{M as cn,j as ii,l as li,P as W,a as P,N as hs,S as ci,k as ms,c as di,E as ui,m as fs,n as pi,o as hi,p as mi,s as fi,q as gi,t as yi,v as zr,w as Fn,T as q,x as Wt,y as Ao,h as K,z as wi,A as gs,B as ki,b as ot,D as rt,R as bi,C as Ci,F as le,G as Ni,g as $e,f as Mi,H as $i,u as xi,r as vi,I as Si,J as Ai,i as Ii}from"./index-i1pBeVdL.js";import{aT as co,aU as uo,aV as po,aC as Ti,aB as zt,aW as Kr,aX as Ri,aY as _i,aZ as Ei}from"./md-editor-C6otpRZL.js";import{q as Oi}from"./index-08JC0wQa.js";var B=(t=>(t.docTypeError="docTypeError",t.contextNotFound="contextNotFound",t.timerNotFound="timerNotFound",t.ctxCallOutOfScope="ctxCallOutOfScope",t.createNodeInParserFail="createNodeInParserFail",t.stackOverFlow="stackOverFlow",t.parserMatchError="parserMatchError",t.serializerMatchError="serializerMatchError",t.getAtomFromSchemaFail="getAtomFromSchemaFail",t.expectDomTypeError="expectDomTypeError",t.callCommandBeforeEditorView="callCommandBeforeEditorView",t.missingRootElement="missingRootElement",t.missingNodeInSchema="missingNodeInSchema",t.missingMarkInSchema="missingMarkInSchema",t.ctxNotBind="ctxNotBind",t.missingYjsDoc="missingYjsDoc",t))(B||{});let U=class extends Error{constructor(e,n){super(n),this.name="MilkdownError",this.code=e}};const Li=(t,e)=>typeof e=="function"?"[Function]":e,st=t=>JSON.stringify(t,Li);function Di(t){return new U(B.docTypeError,`Doc type error, unsupported type: ${st(t)}`)}function Pi(t){return new U(B.contextNotFound,`Context "${t}" not found, do you forget to inject it?`)}function Wi(t){return new U(B.timerNotFound,`Timer "${t}" not found, do you forget to record it?`)}function Io(){return new U(B.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function Bi(...t){const e=t.reduce((n,o)=>{if(!o)return n;const r=s=>Array.isArray(s)?s.map(a=>r(a)).join(", "):s.toJSON?st(s.toJSON()):s.spec?st(s.spec):s.toString();return`${n}, ${r(o)}`},"Create prosemirror node from remark failed in parser");return new U(B.createNodeInParserFail,e)}function ys(){return new U(B.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function Hi(t){return new U(B.parserMatchError,`Cannot match target parser for node: ${st(t)}.`)}function Fi(t){return new U(B.serializerMatchError,`Cannot match target serializer for node: ${st(t)}.`)}function ji(t,e){return new U(B.getAtomFromSchemaFail,`Cannot get ${t}: ${e} from schema.`)}function ue(t){return new U(B.expectDomTypeError,`Expect to be a dom, but get: ${st(t)}.`)}function zi(){return new U(B.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}function Ki(t){return new U(B.missingNodeInSchema,`Missing node in schema, milkdown cannot find "${t}" in schema.`)}function Vi(t){return new U(B.missingMarkInSchema,`Missing mark in schema, milkdown cannot find "${t}" in schema.`)}var ws=t=>{throw TypeError(t)},ks=(t,e,n)=>e.has(t)||ws("Cannot "+n),g=(t,e,n)=>(ks(t,e,"read from private field"),n?n.call(t):e.get(t)),R=(t,e,n)=>e.has(t)?ws("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),x=(t,e,n,o)=>(ks(t,e,"write to private field"),e.set(t,n),n);let bs=class{constructor(){this.sliceMap=new Map,this.get=e=>{const n=typeof e=="string"?[...this.sliceMap.values()].find(o=>o.type.name===e):this.sliceMap.get(e.id);if(!n){const o=typeof e=="string"?e:e.name;throw Pi(o)}return n},this.remove=e=>{const n=typeof e=="string"?[...this.sliceMap.values()].find(o=>o.type.name===e):this.sliceMap.get(e.id);n&&this.sliceMap.delete(n.type.id)},this.has=e=>typeof e=="string"?[...this.sliceMap.values()].some(n=>n.type.name===e):this.sliceMap.has(e.id)}};var ae,ge,mt;let qi=class{constructor(e,n,o){R(this,ae),R(this,ge),R(this,mt),x(this,ae,[]),x(this,mt,()=>{g(this,ae).forEach(r=>r(g(this,ge)))}),this.set=r=>{x(this,ge,r),g(this,mt).call(this)},this.get=()=>g(this,ge),this.update=r=>{x(this,ge,r(g(this,ge))),g(this,mt).call(this)},this.type=o,x(this,ge,n),e.set(o.id,this)}on(e){return g(this,ae).push(e),()=>{x(this,ae,g(this,ae).filter(n=>n!==e))}}once(e){const n=this.on(o=>{e(o),n()});return n}off(e){x(this,ae,g(this,ae).filter(n=>n!==e))}offAll(){x(this,ae,[])}};ae=new WeakMap,ge=new WeakMap,mt=new WeakMap;let Ui=class{constructor(e,n){this.id=Symbol(`Context-${n}`),this.name=n,this._defaultValue=e,this._typeInfo=()=>{throw Io()}}create(e,n=this._defaultValue){return new qi(e,n,this)}};const $=(t,e)=>new Ui(t,e);var dn,un,pn,ze,ft,_e,gt,yt,wt;let Ji=class{constructor(e,n,o){R(this,dn),R(this,un),R(this,pn),R(this,ze),R(this,ft),R(this,_e),R(this,gt),R(this,yt),R(this,wt),x(this,ze,new Set),x(this,ft,new Set),x(this,_e,new Map),x(this,gt,new Map),this.read=()=>({metadata:g(this,dn),injectedSlices:[...g(this,ze)].map(r=>({name:typeof r=="string"?r:r.name,value:g(this,yt).call(this,r)})),consumedSlices:[...g(this,ft)].map(r=>({name:typeof r=="string"?r:r.name,value:g(this,yt).call(this,r)})),recordedTimers:[...g(this,_e)].map(([r,{duration:s}])=>({name:r.name,duration:s,status:g(this,wt).call(this,r)})),waitTimers:[...g(this,gt)].map(([r,{duration:s}])=>({name:r.name,duration:s,status:g(this,wt).call(this,r)}))}),this.onRecord=r=>{g(this,_e).set(r,{start:Date.now(),duration:0})},this.onClear=r=>{g(this,_e).delete(r)},this.onDone=r=>{const s=g(this,_e).get(r);s&&(s.duration=Date.now()-s.start)},this.onWait=(r,s)=>{const a=Date.now();s.finally(()=>{g(this,gt).set(r,{duration:Date.now()-a})})},this.onInject=r=>{g(this,ze).add(r)},this.onRemove=r=>{g(this,ze).delete(r)},this.onUse=r=>{g(this,ft).add(r)},x(this,yt,r=>g(this,un).get(r).get()),x(this,wt,r=>g(this,pn).get(r).status),x(this,un,e),x(this,pn,n),x(this,dn,o)}};dn=new WeakMap,un=new WeakMap,pn=new WeakMap,ze=new WeakMap,ft=new WeakMap,_e=new WeakMap,gt=new WeakMap,yt=new WeakMap,wt=new WeakMap;var ye,we,hn,Z;const Gi=class Cs{constructor(e,n,o){R(this,ye),R(this,we),R(this,hn),R(this,Z),this.produce=r=>r&&Object.keys(r).length?new Cs(g(this,ye),g(this,we),{...r}):this,this.inject=(r,s)=>{var a;const i=r.create(g(this,ye).sliceMap);return s!=null&&i.set(s),(a=g(this,Z))==null||a.onInject(r),this},this.remove=r=>{var s;return g(this,ye).remove(r),(s=g(this,Z))==null||s.onRemove(r),this},this.record=r=>{var s;return r.create(g(this,we).store),(s=g(this,Z))==null||s.onRecord(r),this},this.clearTimer=r=>{var s;return g(this,we).remove(r),(s=g(this,Z))==null||s.onClear(r),this},this.isInjected=r=>g(this,ye).has(r),this.isRecorded=r=>g(this,we).has(r),this.use=r=>{var s;return(s=g(this,Z))==null||s.onUse(r),g(this,ye).get(r)},this.get=r=>this.use(r).get(),this.set=(r,s)=>this.use(r).set(s),this.update=(r,s)=>this.use(r).update(s),this.timer=r=>g(this,we).get(r),this.done=r=>{var s;this.timer(r).done(),(s=g(this,Z))==null||s.onDone(r)},this.wait=r=>{var s;const a=this.timer(r).start();return(s=g(this,Z))==null||s.onWait(r,a),a},this.waitTimers=async r=>{await Promise.all(this.get(r).map(s=>this.wait(s)))},x(this,ye,e),x(this,we,n),x(this,hn,o),o&&x(this,Z,new Ji(e,n,o))}get meta(){return g(this,hn)}get inspector(){return g(this,Z)}};ye=new WeakMap,we=new WeakMap,hn=new WeakMap,Z=new WeakMap;let Xi=Gi,Yi=class{constructor(){this.store=new Map,this.get=e=>{const n=this.store.get(e.id);if(!n)throw Wi(e.name);return n},this.remove=e=>{this.store.delete(e.id)},this.has=e=>this.store.has(e.id)}};var Ke,Ee,kt,ke,bt,mn;let Qi=class{constructor(e,n){R(this,Ke),R(this,Ee),R(this,kt),R(this,ke),R(this,bt),R(this,mn),x(this,Ke,null),x(this,Ee,null),x(this,ke,"pending"),this.start=()=>(g(this,Ke)??x(this,Ke,new Promise((o,r)=>{x(this,Ee,s=>{s instanceof CustomEvent&&s.detail.id===g(this,kt)&&(x(this,ke,"resolved"),g(this,bt).call(this),s.stopImmediatePropagation(),o())}),g(this,mn).call(this,()=>{g(this,ke)==="pending"&&x(this,ke,"rejected"),g(this,bt).call(this),r(new Error(`Timing ${this.type.name} timeout.`))}),x(this,ke,"pending"),addEventListener(this.type.name,g(this,Ee))})),g(this,Ke)),this.done=()=>{const o=new CustomEvent(this.type.name,{detail:{id:g(this,kt)}});dispatchEvent(o)},x(this,bt,()=>{g(this,Ee)&&removeEventListener(this.type.name,g(this,Ee))}),x(this,mn,o=>{setTimeout(()=>{o()},this.type.timeout)}),x(this,kt,Symbol(n.name)),this.type=n,e.set(n.id,this)}get status(){return g(this,ke)}};Ke=new WeakMap,Ee=new WeakMap,kt=new WeakMap,ke=new WeakMap,bt=new WeakMap,mn=new WeakMap;let Zi=class{constructor(e,n=3e3){this.create=o=>new Qi(o,this),this.id=Symbol(`Timer-${e}`),this.name=e,this.timeout=n}};const Se=(t,e=3e3)=>new Zi(t,e);var Ns=t=>{throw TypeError(t)},Ms=(t,e,n)=>e.has(t)||Ns("Cannot "+n),M=(t,e,n)=>(Ms(t,e,"read from private field"),n?n.call(t):e.get(t)),E=(t,e,n)=>e.has(t)?Ns("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),A=(t,e,n,o)=>(Ms(t,e,"write to private field"),e.set(t,n),n);let $s=class{},xs=class{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=e=>{var n;(n=this.top())==null||n.push(e)},this.open=e=>{this.elements.push(e)},this.close=()=>{const e=this.elements.pop();if(!e)throw ys();return e}}},el=class vs extends $s{constructor(e,n,o){super(),this.type=e,this.content=n,this.attrs=o}push(e,...n){this.content.push(e,...n)}pop(){return this.content.pop()}static create(e,n,o){return new vs(e,n,o)}};var ie,Ct,fn,gn,yn,Nt,Mt;const ho=class extends xs{constructor(e){super(),E(this,ie),E(this,Ct),E(this,fn),E(this,gn),E(this,yn),E(this,Nt),E(this,Mt),A(this,ie,cn.none),A(this,Ct,n=>n.isText),A(this,fn,(n,o)=>{if(M(this,Ct).call(this,n)&&M(this,Ct).call(this,o)&&cn.sameSet(n.marks,o.marks))return this.schema.text(n.text+o.text,n.marks)}),A(this,gn,n=>{const o=Object.values({...this.schema.nodes,...this.schema.marks}).find(r=>r.spec.parseMarkdown.match(n));if(!o)throw Hi(n);return o}),A(this,yn,n=>{const o=M(this,gn).call(this,n);o.spec.parseMarkdown.runner(this,n,o)}),this.injectRoot=(n,o,r)=>(this.openNode(o,r),this.next(n.children),this),this.openNode=(n,o)=>(this.open(el.create(n,[],o)),this),A(this,Nt,()=>{A(this,ie,cn.none);const n=this.close();return M(this,Mt).call(this,n.type,n.attrs,n.content)}),this.closeNode=()=>(M(this,Nt).call(this),this),A(this,Mt,(n,o,r)=>{const s=n.createAndFill(o,r,M(this,ie));if(!s)throw Bi(n,o,r);return this.push(s),s}),this.addNode=(n,o,r)=>(M(this,Mt).call(this,n,o,r),this),this.openMark=(n,o)=>{const r=n.create(o);return A(this,ie,r.addToSet(M(this,ie))),this},this.closeMark=n=>(A(this,ie,n.removeFromSet(M(this,ie))),this),this.addText=n=>{const o=this.top();if(!o)throw ys();const r=o.pop(),s=this.schema.text(n,M(this,ie));if(!r)return o.push(s),this;const a=M(this,fn).call(this,r,s);return a?(o.push(a),this):(o.push(r,s),this)},this.build=()=>{let n;do n=M(this,Nt).call(this);while(this.size());return n},this.next=(n=[])=>([n].flat().forEach(o=>M(this,yn).call(this,o)),this),this.toDoc=()=>this.build(),this.run=(n,o)=>{const r=n.runSync(n.parse(o),o);return this.next(r),this},this.schema=e}};ie=new WeakMap,Ct=new WeakMap,fn=new WeakMap,gn=new WeakMap,yn=new WeakMap,Nt=new WeakMap,Mt=new WeakMap,ho.create=(t,e)=>{const n=new ho(t);return o=>(n.run(e,o),n.toDoc())};let tl=ho;const mo=class extends $s{constructor(e,n,o,r={}){super(),this.type=e,this.children=n,this.value=o,this.props=r,this.push=(s,...a)=>{this.children||(this.children=[]),this.children.push(s,...a)},this.pop=()=>{var s;return(s=this.children)==null?void 0:s.pop()}}};mo.create=(t,e,n,o={})=>new mo(t,e,n,o);let Vr=mo;const nl=t=>Object.prototype.hasOwnProperty.call(t,"size");var he,$t,wn,kn,xt,bn,vt,Cn,Nn,Ve,Oe,Mn,St;const fo=class extends xs{constructor(e){super(),E(this,he),E(this,$t),E(this,wn),E(this,kn),E(this,xt),E(this,bn),E(this,vt),E(this,Cn),E(this,Nn),E(this,Ve),E(this,Oe),E(this,Mn),E(this,St),A(this,he,cn.none),A(this,$t,n=>{const o=Object.values({...this.schema.nodes,...this.schema.marks}).find(r=>r.spec.toMarkdown.match(n));if(!o)throw Fi(n.type);return o}),A(this,wn,n=>M(this,$t).call(this,n).spec.toMarkdown.runner(this,n)),A(this,kn,(n,o)=>M(this,$t).call(this,n).spec.toMarkdown.runner(this,n,o)),A(this,xt,n=>{const{marks:o}=n,r=s=>s.type.spec.priority??50;[...o].sort((s,a)=>r(s)-r(a)).every(s=>!M(this,kn).call(this,s,n))&&M(this,wn).call(this,n),o.forEach(s=>M(this,St).call(this,s))}),A(this,bn,(n,o)=>{var r;if(n.type===o||((r=n.children)==null?void 0:r.length)!==1)return n;const s=c=>{var d;if(c.type===o)return c;if(((d=c.children)==null?void 0:d.length)!==1)return null;const[u]=c.children;return u?s(u):null},a=s(n);if(!a)return n;const i=a.children?[...a.children]:void 0,l={...n,children:i};return l.children=i,a.children=[l],a}),A(this,vt,n=>{const{children:o}=n;return o&&(n.children=o.reduce((r,s,a)=>{if(a===0)return[s];const i=r.at(-1);if(i&&i.isMark&&s.isMark){s=M(this,bn).call(this,s,i.type);const{children:l,...c}=s,{children:d,...u}=i;if(s.type===i.type&&l&&d&&JSON.stringify(c)===JSON.stringify(u)){const p={...u,children:[...d,...l]};return r.slice(0,-1).concat(M(this,vt).call(this,p))}}return r.concat(s)},[])),n}),A(this,Cn,n=>{const o={...n.props,type:n.type};return n.children&&(o.children=n.children),n.value&&(o.value=n.value),o}),this.openNode=(n,o,r)=>(this.open(Vr.create(n,void 0,o,r)),this),A(this,Nn,(n,o)=>{let r="",s="";const a=n.children;let i=-1,l=-1;const c=u=>{u&&u.forEach((p,m)=>{p.type==="text"&&p.value&&(i<0&&(i=m),l=m)})};if(a){c(a);const u=a==null?void 0:a[l],p=a==null?void 0:a[i];u&&u.value.endsWith(" ")&&(s=u.value.match(/ +$/)[0],u.value=u.value.trimEnd()),p&&p.value.startsWith(" ")&&(r=p.value.match(/^ +/)[0],p.value=p.value.trimStart())}r.length&&M(this,Oe).call(this,"text",void 0,r);const d=o();return s.length&&M(this,Oe).call(this,"text",void 0,s),d}),A(this,Ve,(n=!1)=>{const o=this.close(),r=()=>M(this,Oe).call(this,o.type,o.children,o.value,o.props);return n?M(this,Nn).call(this,o,r):r()}),this.closeNode=()=>(M(this,Ve).call(this),this),A(this,Oe,(n,o,r,s)=>{const a=Vr.create(n,o,r,s),i=M(this,vt).call(this,M(this,Cn).call(this,a));return this.push(i),i}),this.addNode=(n,o,r,s)=>(M(this,Oe).call(this,n,o,r,s),this),A(this,Mn,(n,o,r,s)=>n.isInSet(M(this,he))?this:(A(this,he,n.addToSet(M(this,he))),this.openNode(o,r,{...s,isMark:!0}))),A(this,St,n=>{n.isInSet(M(this,he))&&(A(this,he,n.type.removeFromSet(M(this,he))),M(this,Ve).call(this,!0))}),this.withMark=(n,o,r,s)=>(M(this,Mn).call(this,n,o,r,s),this),this.closeMark=n=>(M(this,St).call(this,n),this),this.build=()=>{let n=null;do n=M(this,Ve).call(this);while(this.size());return n},this.next=n=>nl(n)?(n.forEach(o=>{M(this,xt).call(this,o)}),this):(M(this,xt).call(this,n),this),this.toString=n=>n.stringify(this.build()),this.run=n=>(this.next(n),this),this.schema=e}};he=new WeakMap,$t=new WeakMap,wn=new WeakMap,kn=new WeakMap,xt=new WeakMap,bn=new WeakMap,vt=new WeakMap,Cn=new WeakMap,Nn=new WeakMap,Ve=new WeakMap,Oe=new WeakMap,Mn=new WeakMap,St=new WeakMap,fo.create=(t,e)=>{const n=new fo(t);return o=>(n.run(o),n.toString(e))};let ol=fo;class H{constructor(e,n,o={}){this.match=e,this.match=e,this.handler=typeof n=="string"?rl(n):n,this.undoable=o.undoable!==!1,this.inCode=o.inCode||!1}}function rl(t){return function(e,n,o,r){let s=t;if(n[1]){let a=n[0].lastIndexOf(n[1]);s+=n[0].slice(a+n[1].length),o+=a;let i=o-r;i>0&&(s=n[0].slice(a-i,a)+s,o=r)}return e.tr.insertText(s,o,r)}}const sl=(t,e)=>{let n=t.plugins;for(let o=0;o<n.length;o++){let r=n[o],s;if(r.spec.isInputRules&&(s=r.getState(t))){if(e){let a=t.tr,i=s.transform;for(let l=i.steps.length-1;l>=0;l--)a.step(i.steps[l].invert(i.docs[l]));if(s.text){let l=a.doc.resolve(s.from).marks();a.replaceWith(s.from,s.to,t.schema.text(s.text,l))}else a.delete(s.from,s.to);e(a)}return!0}}return!1};new H(/--$/,"—");new H(/\.\.\.$/,"…");new H(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new H(/"$/,"”");new H(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new H(/'$/,"’");function To(t,e,n=null,o){return new H(t,(r,s,a,i)=>{let l=n instanceof Function?n(s):n,c=r.tr.delete(a,i),d=c.doc.resolve(a),u=d.blockRange(),p=u&&ii(u,e,l);if(!p)return null;c.wrap(u,p);let m=c.doc.resolve(a-1).nodeBefore;return m&&m.type==e&&li(c.doc,a-1)&&(!o||o(s,m))&&c.join(a-1),c})}function Ss(t,e,n=null){return new H(t,(o,r,s,a)=>{let i=o.doc.resolve(s),l=n instanceof Function?n(r):n;return i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e)?o.tr.delete(s,a).setBlockType(s,s,e,l):null})}const ve=typeof navigator<"u"?navigator:null,qr=typeof document<"u"?document:null,Ae=ve&&ve.userAgent||"",go=/Edge\/(\d+)/.exec(Ae),As=/MSIE \d/.exec(Ae),yo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ae),jn=!!(As||yo||go),al=As?document.documentMode:yo?+yo[1]:go?+go[1]:0,Is=!jn&&/gecko\/(\d+)/i.test(Ae),il=Is&&+(/Firefox\/(\d+)/.exec(Ae)||[0,0])[1],wo=!jn&&/Chrome\/(\d+)/.exec(Ae),ll=!!wo,cl=wo?+wo[1]:0,Ts=!jn&&!!ve&&/Apple Computer/.test(ve.vendor),Rs=Ts&&(/Mobile\/\w+/.test(Ae)||!!ve&&ve.maxTouchPoints>2),dl=Rs||(ve?/Mac/.test(ve.platform):!1),ul=/Android \d/.test(Ae),_s=!!qr&&"webkitFontSmoothing"in qr.documentElement.style,pl=_s?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;var nu=Object.freeze({__proto__:null,android:ul,chrome:ll,chrome_version:cl,gecko:Is,gecko_version:il,ie:jn,ie_version:al,ios:Rs,mac:dl,safari:Ts,webkit:_s,webkit_version:pl});function Yn(t,e,n,o,r,s){var a;if(t.composing)return!1;const i=t.state,l=i.doc.resolve(e);if(l.parent.type.spec.code)return!1;const c=l.parent.textBetween(Math.max(0,l.parentOffset-500),l.parentOffset,void 0,"￼")+o;for(let d=0;d<r.length;d++){const u=r[d].match.exec(c),p=u&&u[0]&&r[d].handler(i,u,e-(u[0].length-o.length),n);if(p)return((a=r[d])==null?void 0:a.undoable)!==!1&&p.setMeta(s,{transform:p,from:e,to:n,text:o}),t.dispatch(p),!0}return!1}const hl=new P("MILKDOWN_CUSTOM_INPUTRULES");function ml({rules:t}){const e=new W({key:hl,isInputRules:!0,state:{init(){return null},apply(n,o){const r=n.getMeta(this);return r||(n.selectionSet||n.docChanged?null:o)}},props:{handleTextInput(n,o,r,s){return Yn(n,o,r,s,t,e)},handleDOMEvents:{compositionend:n=>(setTimeout(()=>{const{$cursor:o}=n.state.selection;o&&Yn(n,o.pos,o.pos,"",t,e)}),!1)},handleKeyDown(n,o){if(o.key!=="Enter")return!1;const{$cursor:r}=n.state.selection;return r?Yn(n,r.pos,r.pos,`
`,t,e):!1}}});return e}function Kt(t,e,n={}){return new H(t,(o,r,s,a)=>{var i,l,c,d;const{tr:u}=o,p=r.length;let m=r[p-1],f=r[0],w=[],C=a;const b={group:m,fullMatch:f,start:s,end:a},D=(i=n.updateCaptured)==null?void 0:i.call(n,b);if(Object.assign(b,D),{group:m,fullMatch:f,start:s,end:a}=b,f===null||(m==null?void 0:m.trim())==="")return null;if(m){const _=f.search(/\S/),pe=s+f.indexOf(m),re=pe+m.length;w=(l=u.storedMarks)!=null?l:[],re<a&&u.delete(re,a),pe>s&&u.delete(s+_,pe),C=s+_+m.length;const je=(c=n.getAttr)==null?void 0:c.call(n,r);u.addMark(s,C,e.create(je)),u.setStoredMarks(w),(d=n.beforeDispatch)==null||d.call(n,{match:r,start:s,end:a,tr:u})}return u})}function ou(t,e,n={}){return new H(t,(o,r,s,a)=>{var i,l,c;const{tr:d}=o;let u=r[1],p=r[0];const m={group:u,fullMatch:p,start:s,end:a},f=(i=n.updateCaptured)==null?void 0:i.call(n,m);if(Object.assign(m,f),{group:u,fullMatch:p,start:s,end:a}=m,p===null||!u||u.trim()==="")return null;const w=(l=n.getAttr)==null?void 0:l.call(n,r),C=e.createAndFill(w);return C&&(d.replaceRangeWith(e.isBlock?d.doc.resolve(s).before():s,a,C),(c=n.beforeDispatch)==null||c.call(n,{match:[p,u??""],start:s,end:a,tr:d})),d})}var fl=Object.defineProperty,gl=Object.defineProperties,yl=Object.getOwnPropertyDescriptors,Ur=Object.getOwnPropertySymbols,wl=Object.prototype.hasOwnProperty,kl=Object.prototype.propertyIsEnumerable,Jr=(t,e,n)=>e in t?fl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bl=(t,e)=>{for(var n in e||(e={}))wl.call(e,n)&&Jr(t,n,e[n]);if(Ur)for(var n of Ur(e))kl.call(e,n)&&Jr(t,n,e[n]);return t},Cl=(t,e)=>gl(t,yl(e));function Gr(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function ru(t,e,n){const r=t.state.doc.content.size,s=Gr(e,0,r),a=Gr(n,0,r),i=t.coordsAtPos(s),l=t.coordsAtPos(a,-1),c=Math.min(i.top,l.top),d=Math.max(i.bottom,l.bottom),u=Math.min(i.left,l.left),p=Math.max(i.right,l.right),m=p-u,f=d-c,b={top:c,bottom:d,left:u,right:p,width:m,height:f,x:u,y:c};return Cl(bl({},b),{toJSON:()=>b})}function zn(t){return Object.assign(Object.create(t),t).setTime(Date.now())}function Nl(t,e){return Array.isArray(t)&&t.includes(e.type)||e.type===t}function Ml(t){return e=>{for(let n=e.depth;n>0;n-=1){const o=e.node(n);if(t(o)){const r=e.before(n),s=e.after(n);return{from:r,to:s,node:o}}}}}function $l(t,e){return Ml(n=>n.type===e)(t)}function xl(t,e){const n=e.nodes[t];if(!n)throw ji("node",t);return n}function Ro(t){return e=>{for(let n=e.depth;n>0;n--){const o=e.node(n);if(t(o))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:o}}}}function su(t){return e=>Ro(t)(e.$from)}function vl(t,e){if(!(t instanceof hs))return;const{node:n,$from:o}=t;if(Nl(e,n))return{node:n,pos:o.pos,start:o.start(o.depth),depth:o.depth}}var Es=t=>{throw TypeError(t)},Os=(t,e,n)=>e.has(t)||Es("Cannot "+n),y=(t,e,n)=>(Os(t,e,"read from private field"),n?n.call(t):e.get(t)),L=(t,e,n)=>e.has(t)?Es("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),T=(t,e,n,o)=>(Os(t,e,"write to private field"),e.set(t,n),n);function Ie(t,e){return t.meta={package:"@milkdown/core",group:"System",...e},t}const Ls={strong:(t,e,n,o)=>{const r=t.marker||n.options.strong||"*",s=n.enter("strong"),a=n.createTracker(o);let i=a.move(r+r);return i+=a.move(n.containerPhrasing(t,{before:i,after:r,...a.current()})),i+=a.move(r+r),s(),i},emphasis:(t,e,n,o)=>{const r=t.marker||n.options.emphasis||"*",s=n.enter("emphasis"),a=n.createTracker(o);let i=a.move(r);return i+=a.move(n.containerPhrasing(t,{before:i,after:r,...a.current()})),i+=a.move(r),s(),i}},Qe=$({},"editorView"),At=$({},"editorState"),Qn=$([],"initTimer"),Xr=$({},"editor"),Bt=$([],"inputRules"),ce=$([],"prosePlugins"),Ht=$([],"remarkPlugins"),Ft=$([],"nodeView"),jt=$([],"markView"),Pe=$(co().use(uo).use(po),"remark"),Et=$({handlers:Ls},"remarkStringifyOptions"),$n=Se("ConfigReady");function Sl(t){const e=n=>(n.record($n),async()=>(await t(n),n.done($n),()=>{n.clearTimer($n)}));return Ie(e,{displayName:"Config"}),e}const We=Se("InitReady");function Al(t){const e=n=>(n.inject(Xr,t).inject(ce,[]).inject(Ht,[]).inject(Bt,[]).inject(Ft,[]).inject(jt,[]).inject(Et,{handlers:Ls}).inject(Pe,co().use(uo).use(po)).inject(Qn,[$n]).record(We),async()=>{await n.waitTimers(Qn);const o=n.get(Et);return n.set(Pe,co().use(uo).use(po,o)),n.done(We),()=>{n.remove(Xr).remove(ce).remove(Ht).remove(Bt).remove(Ft).remove(jt).remove(Et).remove(Pe).remove(Qn).clearTimer(We)}});return Ie(e,{displayName:"Init"}),e}const te=Se("SchemaReady"),Zn=$([],"schemaTimer"),fe=$({},"schema"),Ze=$([],"nodes"),et=$([],"marks");function Yr(t){var e;return{...t,parseDOM:(e=t.parseDOM)==null?void 0:e.map(n=>({priority:t.priority,...n}))}}const Ds=t=>(t.inject(fe,{}).inject(Ze,[]).inject(et,[]).inject(Zn,[We]).record(te),async()=>{await t.waitTimers(Zn);const e=t.get(Pe),n=t.get(Ht).reduce((a,i)=>a.use(i.plugin,i.options),e);t.set(Pe,n);const o=Object.fromEntries(t.get(Ze).map(([a,i])=>[a,Yr(i)])),r=Object.fromEntries(t.get(et).map(([a,i])=>[a,Yr(i)])),s=new ci({nodes:o,marks:r});return t.set(fe,s),t.done(te),()=>{t.remove(fe).remove(Ze).remove(et).remove(Zn).clearTimer(te)}});Ie(Ds,{displayName:"Schema"});var qe,Le;let Ps=class{constructor(){L(this,qe),L(this,Le),T(this,qe,new bs),T(this,Le,null),this.setCtx=e=>{T(this,Le,e)}}get ctx(){return y(this,Le)}create(e,n){const o=e.create(y(this,qe).sliceMap);return o.set(n),o}get(e){return y(this,qe).get(e).get()}remove(e){return y(this,qe).remove(e)}call(e,n){if(y(this,Le)==null)throw zi();const o=this.get(e)(n),r=y(this,Le).get(Qe);return o(r.state,r.dispatch,r)}};qe=new WeakMap,Le=new WeakMap;function Il(t="cmdKey"){return $(()=>()=>!1,t)}const v=$(new Ps,"commands"),eo=$([te],"commandsTimer"),Ot=Se("CommandsReady"),Ws=t=>{const e=new Ps;return e.setCtx(t),t.inject(v,e).inject(eo,[te]).record(Ot),async()=>(await t.waitTimers(eo),t.done(Ot),()=>{t.remove(v).remove(eo).clearTimer(Ot)})};Ie(Ws,{displayName:"Commands"});const xn=Se("ParserReady"),Bs=()=>{throw Io()},Lt=$(Bs,"parser"),to=$([],"parserTimer"),Hs=t=>(t.inject(Lt,Bs).inject(to,[te]).record(xn),async()=>{await t.waitTimers(to);const e=t.get(Pe),n=t.get(fe);return t.set(Lt,tl.create(n,e)),t.done(xn),()=>{t.remove(Lt).remove(to).clearTimer(xn)}});Ie(Hs,{displayName:"Parser"});const Dt=Se("SerializerReady"),no=$([],"serializerTimer"),Fs=()=>{throw Io()},tt=$(Fs,"serializer"),js=t=>(t.inject(tt,Fs).inject(no,[te]).record(Dt),async()=>{await t.waitTimers(no);const e=t.get(Pe),n=t.get(fe);return t.set(tt,ol.create(n,e)),t.done(Dt),()=>{t.remove(tt).remove(no).clearTimer(Dt)}});Ie(js,{displayName:"Serializer"});const vn=$("","defaultValue"),oo=$(t=>t,"stateOptions"),ro=$([],"editorStateTimer"),Sn=Se("EditorStateReady");function Tl(t,e,n){if(typeof t=="string")return e(t);if(t.type==="html")return fs.fromSchema(n).parse(t.dom);if(t.type==="json")return pi.fromJSON(n,t.value);throw Di(t)}const Rl=new P("MILKDOWN_STATE_TRACKER");function _l(t){const e=hi(sl,yi,gi,fi);return t.Backspace=e,t}const zs=t=>(t.inject(vn,"").inject(At,{}).inject(oo,e=>e).inject(ro,[xn,Dt,Ot]).record(Sn),async()=>{await t.waitTimers(ro);const e=t.get(fe),n=t.get(Lt),o=t.get(Bt),r=t.get(oo),s=t.get(ce),a=t.get(vn),i=Tl(a,n,e),l=[...s,new W({key:Rl,state:{init:()=>{},apply:(u,p,m,f)=>{t.set(At,f)}}}),ml({rules:o}),ms(_l(mi))];t.set(ce,l);const c=r({schema:e,doc:i,plugins:l}),d=di.create(c);return t.set(At,d),t.done(Sn),()=>{t.remove(vn).remove(At).remove(oo).remove(ro).clearTimer(Sn)}});Ie(zs,{displayName:"EditorState"});const An=Se("EditorViewReady"),so=$([],"editorViewTimer"),Pt=$({},"editorViewOptions"),In=$(null,"root"),ko=$(null,"rootDOM"),bo=$({},"rootAttrs");function El(t,e){const n=document.createElement("div");n.className="milkdown",t.appendChild(n),e.set(ko,n);const o=e.get(bo);return Object.entries(o).forEach(([r,s])=>n.setAttribute(r,s)),n}function Ol(t){t.classList.add("editor"),t.setAttribute("role","textbox")}const Ll=new P("MILKDOWN_VIEW_CLEAR"),Ks=t=>(t.inject(In,document.body).inject(Qe,{}).inject(Pt,{}).inject(ko,null).inject(bo,{}).inject(so,[Sn]).record(An),async()=>{await t.wait(We);const e=t.get(In)||document.body,n=typeof e=="string"?document.querySelector(e):e;t.update(ce,l=>[new W({key:Ll,view:c=>{const d=n?El(n,t):void 0;return(()=>{if(d&&n){const u=c.dom;n.replaceChild(d,u),d.appendChild(u)}})(),{destroy:()=>{d!=null&&d.parentNode&&(d==null||d.parentNode.replaceChild(c.dom,d)),d==null||d.remove()}}}}),...l]),await t.waitTimers(so);const o=t.get(At),r=t.get(Pt),s=Object.fromEntries(t.get(Ft)),a=Object.fromEntries(t.get(jt)),i=new ui(n,{state:o,nodeViews:s,markViews:a,...r});return Ol(i.dom),t.set(Qe,i),t.done(An),()=>{i==null||i.destroy(),t.remove(In).remove(Qe).remove(Pt).remove(ko).remove(bo).remove(so).clearTimer(An)}});Ie(Ks,{displayName:"EditorView"});var Vs=(t=>(t.Idle="Idle",t.OnCreate="OnCreate",t.Created="Created",t.OnDestroy="OnDestroy",t.Destroyed="Destroyed",t))(Vs||{}),Ue,G,be,It,Tn,Rn,z,Ce,Je,_n,Ge,Tt,En,De,Rt;const Dl=class qs{constructor(){L(this,Ue),L(this,G),L(this,be),L(this,It),L(this,Tn),L(this,Rn),L(this,z),L(this,Ce),L(this,Je),L(this,_n),L(this,Ge),L(this,Tt),L(this,En),L(this,De),L(this,Rt),T(this,Ue,!1),T(this,G,"Idle"),T(this,be,[]),T(this,It,()=>{}),T(this,Tn,new bs),T(this,Rn,new Yi),T(this,z,new Map),T(this,Ce,new Map),T(this,Je,new Xi(y(this,Tn),y(this,Rn))),T(this,_n,()=>{const e=Sl(async o=>{await Promise.all(y(this,be).map(r=>r(o)))}),n=[Ds,Hs,js,Ws,zs,Ks,Al(this),e];y(this,Ge).call(this,n,y(this,Ce))}),T(this,Ge,(e,n)=>{e.forEach(o=>{const r=y(this,Je).produce(y(this,Ue)?o.meta:void 0),s=o(r);n.set(o,{ctx:r,handler:s,cleanup:void 0})})}),T(this,Tt,(e,n=!1)=>Promise.all([e].flat().map(o=>{const r=y(this,z).get(o),s=r==null?void 0:r.cleanup;return n?y(this,z).delete(o):y(this,z).set(o,{ctx:void 0,handler:void 0,cleanup:void 0}),typeof s=="function"?s():s}))),T(this,En,async()=>{await Promise.all([...y(this,Ce).entries()].map(([e,{cleanup:n}])=>typeof n=="function"?n():n)),y(this,Ce).clear()}),T(this,De,e=>{T(this,G,e),y(this,It).call(this,e)}),T(this,Rt,e=>[...e.entries()].map(async([n,o])=>{const{ctx:r,handler:s}=o;if(!s)return;const a=await s();e.set(n,{ctx:r,handler:s,cleanup:a})})),this.enableInspector=(e=!0)=>(T(this,Ue,e),this),this.onStatusChange=e=>(T(this,It,e),this),this.config=e=>(y(this,be).push(e),this),this.removeConfig=e=>(T(this,be,y(this,be).filter(n=>n!==e)),this),this.use=e=>{const n=[e].flat();return n.flat().forEach(o=>{y(this,z).set(o,{ctx:void 0,handler:void 0,cleanup:void 0})}),y(this,G)==="Created"&&y(this,Ge).call(this,n,y(this,z)),this},this.remove=async e=>y(this,G)==="OnCreate"?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(n=>{setTimeout(()=>{n(this.remove(e))},50)})):(await y(this,Tt).call(this,[e].flat(),!0),this),this.create=async()=>y(this,G)==="OnCreate"?this:(y(this,G)==="Created"&&await this.destroy(),y(this,De).call(this,"OnCreate"),y(this,_n).call(this),y(this,Ge).call(this,[...y(this,z).keys()],y(this,z)),await Promise.all([y(this,Rt).call(this,y(this,Ce)),y(this,Rt).call(this,y(this,z))].flat()),y(this,De).call(this,"Created"),this),this.destroy=async(e=!1)=>y(this,G)==="Destroyed"||y(this,G)==="OnDestroy"?this:y(this,G)==="OnCreate"?new Promise(n=>{setTimeout(()=>{n(this.destroy(e))},50)}):(e&&T(this,be,[]),y(this,De).call(this,"OnDestroy"),await y(this,Tt).call(this,[...y(this,z).keys()],e),await y(this,En).call(this),y(this,De).call(this,"Destroyed"),this),this.action=e=>e(y(this,Je)),this.inspect=()=>y(this,Ue)?[...y(this,Ce).values(),...y(this,z).values()].map(({ctx:e})=>{var n;return(n=e==null?void 0:e.inspector)==null?void 0:n.read()}).filter(e=>!!e):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new qs}get ctx(){return y(this,Je)}get status(){return y(this,G)}};Ue=new WeakMap,G=new WeakMap,be=new WeakMap,It=new WeakMap,Tn=new WeakMap,Rn=new WeakMap,z=new WeakMap,Ce=new WeakMap,Je=new WeakMap,_n=new WeakMap,Ge=new WeakMap,Tt=new WeakMap,En=new WeakMap,De=new WeakMap,Rt=new WeakMap;let Pl=Dl;Ti("abcedfghicklmn",10);function N(t,e){const n=Il(t),o=r=>async()=>{o.key=n,await r.wait(Ot);const s=e(r);return r.get(v).create(n,s),o.run=a=>r.get(v).call(t,a),()=>{r.get(v).remove(n)}};return o}function F(t){const e=n=>async()=>{await n.wait(te);const o=t(n);return n.update(Bt,r=>[...r,o]),e.inputRule=o,()=>{n.update(Bt,r=>r.filter(s=>s!==o))}};return e}function Wl(t,e){const n=o=>async()=>{const r=e(o);return o.update(et,s=>[...s.filter(a=>a[0]!==t),[t,r]]),n.id=t,n.schema=r,()=>{o.update(et,s=>s.filter(([a])=>a!==t))}};return n.type=o=>{const r=o.get(fe).marks[t];if(!r)throw Vi(t);return r},n}function _o(t,e){const n=o=>async()=>{const r=e(o);return o.update(Ze,s=>[...s.filter(a=>a[0]!==t),[t,r]]),n.id=t,n.schema=r,()=>{o.update(Ze,s=>s.filter(([a])=>a!==t))}};return n.type=o=>{const r=o.get(fe).nodes[t];if(!r)throw Ki(t);return r},n}function Y(t){let e;const n=o=>async()=>(await o.wait(te),e=t(o),o.update(ce,r=>[...r,e]),()=>{o.update(ce,r=>r.filter(s=>s!==e))});return n.plugin=()=>e,n.key=()=>e.spec.key,n}function Us(t){const e=n=>async()=>{await n.wait(te);const o=t(n),r=ms(o);return n.update(ce,s=>[...s,r]),e.keymap=o,()=>{n.update(ce,s=>s.filter(a=>a!==r))}};return e}function iu(t,e){const n=o=>async()=>{await o.wait(te);const r=e(o);return t.type(o)instanceof zr?o.update(Ft,s=>[...s,[t.id,r]]):o.update(jt,s=>[...s,[t.id,r]]),n.view=r,n.type=t,()=>{t.type(o)instanceof zr?o.update(Ft,s=>s.filter(a=>a[0]!==t.id)):o.update(jt,s=>s.filter(a=>a[0]!==t.id))}};return n}function ne(t,e){const n=$(t,e),o=r=>(r.inject(n),()=>()=>{r.remove(n)});return o.key=n,o}function O(t,e){const n=ne(e,t),o=_o(t,s=>s.get(n.key)(s)),r=[n,o];return r.id=o.id,r.node=o,r.type=s=>o.type(s),r.schema=o.schema,r.ctx=n,r.key=n.key,r.extendSchema=s=>a=>()=>{const i=a.get(n.key),l=s(i)(a);a.update(Ze,c=>[...c.filter(d=>d[0]!==t),[t,l]]),r.schema=l},r}function Vt(t,e){const n=ne(e,t),o=Wl(t,s=>s.get(n.key)(s)),r=[n,o];return r.id=o.id,r.mark=o,r.type=o.type,r.schema=o.schema,r.ctx=n,r.key=n.key,r.extendSchema=s=>a=>()=>{const i=a.get(n.key),l=s(i)(a);a.update(et,c=>[...c.filter(d=>d[0]!==t),[t,l]]),r.schema=l},r}function j(t,e){const n=Object.fromEntries(Object.entries(e).map(([a,{shortcuts:i}])=>[a,i])),o=ne(n,`${t}Keymap`),r=Us(a=>{const i=a.get(o.key),l=Object.entries(e).flatMap(([c,{command:d}])=>[i[c]].flat().map(u=>[u,d(a)]));return Object.fromEntries(l)}),s=[o,r];return s.ctx=o,s.shortcuts=r,s.key=o.key,s.keymap=r.keymap,s}const oe=(t,e=()=>({}))=>ne(e,`${t}Attr`),qt=(t,e=()=>({}))=>ne(e,`${t}Attr`);function at(t,e,n){const o=ne({},t),r=a=>async()=>{await a.wait(We);const i={plugin:e(a),options:a.get(o.key)};return a.update(Ht,l=>[...l,i]),()=>{a.update(Ht,l=>l.filter(c=>c!==i))}},s=[o,r];return s.id=t,s.plugin=r,s.options=o,s}function Bl(){return t=>{const e=t.get(Qe);return t.get(tt)(e.state.doc)}}function Hl(t){const e=new Map;if(!t||!t.type)throw new Error("mdast-util-definitions expected node");return zt(t,"definition",function(o){const r=Qr(o.identifier);r&&!e.get(r)&&e.set(r,o)}),n;function n(o){const r=Qr(o);return e.get(r)}}function Qr(t){return String(t||"").toUpperCase()}function Fl(){return function(t){const e=Hl(t);zt(t,function(n,o,r){if(n.type==="definition"&&r!==void 0&&typeof o=="number")return r.children.splice(o,1),[Kr,o];if(n.type==="imageReference"||n.type==="linkReference"){const s=e(n.identifier);if(s&&r&&typeof o=="number")return r.children[o]=n.type==="imageReference"?{type:"image",url:s.url,title:s.title,alt:n.alt}:{type:"link",url:s.url,title:s.title,children:n.children},[Kr,o]}})}}function Js(t,e){var n;if(!(e.childCount>=1&&((n=e.lastChild)==null?void 0:n.type.name)==="hardbreak")){t.next(e.content);return}const o=[];e.content.forEach((r,s,a)=>{a!==e.childCount-1&&o.push(r)}),t.next(le.fromArray(o))}function h(t,e){return Object.assign(t,{meta:{package:"@milkdown/preset-commonmark",...e}}),t}const Eo=qt("emphasis");h(Eo,{displayName:"Attr<emphasis>",group:"Emphasis"});const it=Vt("emphasis",t=>({attrs:{marker:{default:t.get(Et).emphasis||"*"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"}],toDOM:e=>["em",t.get(Eo.key)(e)],parseMarkdown:{match:e=>e.type==="emphasis",runner:(e,n,o)=>{e.openMark(o,{marker:n.marker}),e.next(n.children),e.closeMark(o)}},toMarkdown:{match:e=>e.type.name==="emphasis",runner:(e,n)=>{e.withMark(n,"emphasis",void 0,{marker:n.attrs.marker})}}}));h(it.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"});h(it.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const Oo=N("ToggleEmphasis",t=>()=>Fn(it.type(t)));h(Oo,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const Gs=F(t=>Kt(/(?:^|[^*])\*([^*]+)\*$/,it.type(t),{getAttr:()=>({marker:"*"}),updateCaptured:({fullMatch:e,start:n})=>e.startsWith("*")?{}:{fullMatch:e.slice(1),start:n+1}}));h(Gs,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const Xs=F(t=>Kt(/(?:^|[^_])_([^_]+)_$/,it.type(t),{getAttr:()=>({marker:"_"}),updateCaptured:({fullMatch:e,start:n})=>e.startsWith("_")?{}:{fullMatch:e.slice(1),start:n+1}}));h(Xs,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const Lo=j("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:t=>{const e=t.get(v);return()=>e.call(Oo.key)}}});h(Lo.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"});h(Lo.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const Do=qt("strong");h(Do,{displayName:"Attr<strong>",group:"Strong"});const Ut=Vt("strong",t=>({attrs:{marker:{default:t.get(Et).strong||"*"}},parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>e==="bold"}],toDOM:e=>["strong",t.get(Do.key)(e)],parseMarkdown:{match:e=>e.type==="strong",runner:(e,n,o)=>{e.openMark(o,{marker:n.marker}),e.next(n.children),e.closeMark(o)}},toMarkdown:{match:e=>e.type.name==="strong",runner:(e,n)=>{e.withMark(n,"strong",void 0,{marker:n.attrs.marker})}}}));h(Ut.mark,{displayName:"MarkSchema<strong>",group:"Strong"});h(Ut.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const Po=N("ToggleStrong",t=>()=>Fn(Ut.type(t)));h(Po,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const Ys=F(t=>Kt(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,Ut.type(t),{getAttr:e=>({marker:e[0].startsWith("*")?"*":"_"})}));h(Ys,{displayName:"InputRule<strong>",group:"Strong"});const Wo=j("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:t=>{const e=t.get(v);return()=>e.call(Po.key)}}});h(Wo.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"});h(Wo.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const Bo=qt("inlineCode");h(Bo,{displayName:"Attr<inlineCode>",group:"InlineCode"});const xe=Vt("inlineCode",t=>({priority:100,code:!0,inclusive:!1,parseDOM:[{tag:"code"}],toDOM:e=>["code",t.get(Bo.key)(e)],parseMarkdown:{match:e=>e.type==="inlineCode",runner:(e,n,o)=>{e.openMark(o),e.addText(n.value),e.closeMark(o)}},toMarkdown:{match:e=>e.type.name==="inlineCode",runner:(e,n,o)=>{e.withMark(n,"inlineCode",o.text||"")}}}));h(xe.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"});h(xe.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const Ho=N("ToggleInlineCode",t=>()=>(e,n)=>{const{selection:o,tr:r}=e;if(o.empty)return!1;const{from:s,to:a}=o;return e.doc.rangeHasMark(s,a,xe.type(t))?(n==null||n(r.removeMark(s,a,xe.type(t))),!0):(Object.keys(e.schema.marks).filter(i=>i!==xe.type.name).map(i=>e.schema.marks[i]).forEach(i=>{r.removeMark(s,a,i)}),n==null||n(r.addMark(s,a,xe.type(t).create())),!0)});h(Ho,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const Qs=F(t=>Kt(/(?:`)([^`]+)(?:`)$/,xe.type(t)));h(Qs,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const Fo=j("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:t=>{const e=t.get(v);return()=>e.call(Ho.key)}}});h(Fo.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"});h(Fo.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const jo=qt("link");h(jo,{displayName:"Attr<link>",group:"Link"});const nt=Vt("link",t=>({attrs:{href:{},title:{default:null}},parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw ue(e);return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",{...t.get(jo.key)(e),...e.attrs}],parseMarkdown:{match:e=>e.type==="link",runner:(e,n,o)=>{const r=n.url,s=n.title;e.openMark(o,{href:r,title:s}),e.next(n.children),e.closeMark(o)}},toMarkdown:{match:e=>e.type.name==="link",runner:(e,n)=>{e.withMark(n,"link",void 0,{title:n.attrs.title,url:n.attrs.href})}}}));h(nt.mark,{displayName:"MarkSchema<link>",group:"Link"});const Zs=N("ToggleLink",t=>(e={})=>Fn(nt.type(t),e));h(Zs,{displayName:"Command<toggleLinkCommand>",group:"Link"});const ea=N("UpdateLink",t=>(e={})=>(n,o)=>{if(!o)return!1;let r,s=-1;const{selection:a}=n,{from:i,to:l}=a;if(n.doc.nodesBetween(i,i===l?l+1:l,(f,w)=>{if(nt.type(t).isInSet(f.marks))return r=f,s=w,!1}),!r)return!1;const c=r.marks.find(({type:f})=>f===nt.type(t));if(!c)return!1;const d=s,u=s+r.nodeSize,{tr:p}=n,m=nt.type(t).create({...c.attrs,...e});return m?(o(p.removeMark(d,u,c).addMark(d,u,m).setSelection(new q(p.selection.$anchor)).scrollIntoView()),!0):!1});h(ea,{displayName:"Command<updateLinkCommand>",group:"Link"});const ta=_o("doc",()=>({content:"block+",parseMarkdown:{match:({type:t})=>t==="root",runner:(t,e,n)=>{t.injectRoot(e,n)}},toMarkdown:{match:t=>t.type.name==="doc",runner:(t,e)=>{t.openNode("root"),t.next(e.content)}}}));h(ta,{displayName:"NodeSchema<doc>",group:"Doc"});const zo=oe("paragraph");h(zo,{displayName:"Attr<paragraph>",group:"Paragraph"});const Te=O("paragraph",t=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",t.get(zo.key)(e),0],parseMarkdown:{match:e=>e.type==="paragraph",runner:(e,n,o)=>{e.openNode(o),n.children?e.next(n.children):e.addText(n.value||""),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="paragraph",runner:(e,n)=>{e.openNode("paragraph"),Js(e,n),e.closeNode()}}}));h(Te.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"});h(Te.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const Ko=N("TurnIntoText",t=>()=>Wt(Te.type(t)));h(Ko,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const Vo=j("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:t=>{const e=t.get(v);return()=>e.call(Ko.key)}}});h(Vo.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"});h(Vo.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const jl=Array(6).fill(0).map((t,e)=>e+1);function zl(t){return t.textContent.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-")}const Kn=ne(zl,"headingIdGenerator");h(Kn,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const qo=oe("heading");h(qo,{displayName:"Attr<heading>",group:"Heading"});const Fe=O("heading",t=>{const e=t.get(Kn.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:""},level:{default:1}},parseDOM:jl.map(n=>({tag:`h${n}`,getAttrs:o=>{if(!(o instanceof HTMLElement))throw ue(o);return{level:n,id:o.id}}})),toDOM:n=>[`h${n.attrs.level}`,{...t.get(qo.key)(n),id:n.attrs.id||e(n)},0],parseMarkdown:{match:({type:n})=>n==="heading",runner:(n,o,r)=>{const s=o.depth;n.openNode(r,{level:s}),n.next(o.children),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="heading",runner:(n,o)=>{n.openNode("heading",void 0,{depth:o.attrs.level}),Js(n,o),n.closeNode()}}}});h(Fe.node,{displayName:"NodeSchema<heading>",group:"Heading"});h(Fe.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const na=F(t=>Ss(/^(?<hashes>#+)\s$/,Fe.type(t),e=>{var n,o;const r=((o=(n=e.groups)==null?void 0:n.hashes)==null?void 0:o.length)||0,s=t.get(Qe),{$from:a}=s.state.selection,i=a.node();if(i.type.name==="heading"){let l=Number(i.attrs.level)+Number(r);return l>6&&(l=6),{level:l}}return{level:r}}));h(na,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const Ne=N("WrapInHeading",t=>e=>(e??(e=1),e<1?Wt(Te.type(t)):Wt(Fe.type(t),{level:e})));h(Ne,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const Uo=N("DowngradeHeading",t=>()=>(e,n,o)=>{const{$from:r}=e.selection,s=r.node();if(s.type!==Fe.type(t)||!e.selection.empty||r.parentOffset!==0)return!1;const a=s.attrs.level-1;return a?(n==null||n(e.tr.setNodeMarkup(e.selection.$from.before(),void 0,{...s.attrs,level:a})),!0):Wt(Te.type(t))(e,n,o)});h(Uo,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const Jo=j("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:t=>{const e=t.get(v);return()=>e.call(Ne.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:t=>{const e=t.get(v);return()=>e.call(Ne.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:t=>{const e=t.get(v);return()=>e.call(Ne.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:t=>{const e=t.get(v);return()=>e.call(Ne.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:t=>{const e=t.get(v);return()=>e.call(Ne.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:t=>{const e=t.get(v);return()=>e.call(Ne.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:t=>{const e=t.get(v);return()=>e.call(Uo.key)}}});h(Jo.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"});h(Jo.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const Go=oe("blockquote");h(Go,{displayName:"Attr<blockquote>",group:"Blockquote"});const Jt=O("blockquote",t=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",t.get(Go.key)(e),0],parseMarkdown:{match:({type:e})=>e==="blockquote",runner:(e,n,o)=>{e.openNode(o).next(n.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="blockquote",runner:(e,n)=>{e.openNode("blockquote").next(n.content).closeNode()}}}));h(Jt.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"});h(Jt.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const oa=F(t=>To(/^\s*>\s$/,Jt.type(t)));h(oa,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const Xo=N("WrapInBlockquote",t=>()=>Ao(Jt.type(t)));h(Xo,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const Yo=j("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:t=>{const e=t.get(v);return()=>e.call(Xo.key)}}});h(Yo.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"});h(Yo.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const Qo=oe("codeBlock",()=>({pre:{},code:{}}));h(Qo,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const Gt=O("code_block",t=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw ue(e);return{language:e.dataset.language}}}],toDOM:e=>{const n=t.get(Qo.key)(e);return["pre",{...n.pre,"data-language":e.attrs.language},["code",n.code,0]]},parseMarkdown:{match:({type:e})=>e==="code",runner:(e,n,o)=>{const r=n.lang,s=n.value;e.openNode(o,{language:r}),s&&e.addText(s),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="code_block",runner:(e,n)=>{var o;e.addNode("code",void 0,((o=n.content.firstChild)==null?void 0:o.text)||"",{lang:n.attrs.language})}}}));h(Gt.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"});h(Gt.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const ra=F(t=>Ss(/^```(?<language>[a-z]*)?[\s\n]$/,Gt.type(t),e=>{var n;return{language:((n=e.groups)==null?void 0:n.language)??""}}));h(ra,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const Zo=N("CreateCodeBlock",t=>(e="")=>Wt(Gt.type(t),{language:e}));h(Zo,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});const Kl=N("UpdateCodeBlockLanguage",()=>({pos:t,language:e}={pos:-1,language:""})=>(n,o)=>t>=0?(o==null||o(n.tr.setNodeAttribute(t,"language",e)),!0):!1);h(Kl,{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const er=j("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:t=>{const e=t.get(v);return()=>e.call(Zo.key)}}});h(er.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"});h(er.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const tr=oe("image");h(tr,{displayName:"Attr<image>",group:"Image"});const lt=O("image",t=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:""},alt:{default:""},title:{default:""}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw ue(e);return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt")||"",title:e.getAttribute("title")||e.getAttribute("alt")||""}}}],toDOM:e=>["img",{...t.get(tr.key)(e),...e.attrs}],parseMarkdown:{match:({type:e})=>e==="image",runner:(e,n,o)=>{const r=n.url,s=n.alt,a=n.title;e.addNode(o,{src:r,alt:s,title:a})}},toMarkdown:{match:e=>e.type.name==="image",runner:(e,n)=>{e.addNode("image",void 0,void 0,{title:n.attrs.title,url:n.attrs.src,alt:n.attrs.alt})}}}));h(lt.node,{displayName:"NodeSchema<image>",group:"Image"});h(lt.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const sa=N("InsertImage",t=>(e={})=>(n,o)=>{if(!o)return!0;const{src:r="",alt:s="",title:a=""}=e,i=lt.type(t).create({src:r,alt:s,title:a});return i&&o(n.tr.replaceSelectionWith(i).scrollIntoView()),!0});h(sa,{displayName:"Command<insertImageCommand>",group:"Image"});const aa=N("UpdateImage",t=>(e={})=>(n,o)=>{const r=vl(n.selection,lt.type(t));if(!r)return!1;const{node:s,pos:a}=r,i={...s.attrs},{src:l,alt:c,title:d}=e;return l!==void 0&&(i.src=l),c!==void 0&&(i.alt=c),d!==void 0&&(i.title=d),o==null||o(n.tr.setNodeMarkup(a,void 0,i).scrollIntoView()),!0});h(aa,{displayName:"Command<updateImageCommand>",group:"Image"});const Vl=F(t=>new H(/!\[(?<alt>.*?)]\((?<filename>.*?)\s*(?="|\))"?(?<title>[^"]+)?"?\)/,(e,n,o,r)=>{const[s,a,i="",l]=n;return s?e.tr.replaceWith(o,r,lt.type(t).create({src:i,alt:a,title:l})):null}));h(Vl,{displayName:"InputRule<insertImageInputRule>",group:"Image"});const Wn=oe("hardbreak",t=>({"data-type":"hardbreak","data-is-inline":t.attrs.isInline}));h(Wn,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const Be=O("hardbreak",t=>({inline:!0,group:"inline",attrs:{isInline:{default:!1}},selectable:!1,parseDOM:[{tag:"br"},{tag:'span[data-type="hardbreak"]',getAttrs:()=>({isInline:!0})}],toDOM:e=>e.attrs.isInline?["span",t.get(Wn.key)(e)," "]:["br",t.get(Wn.key)(e)],parseMarkdown:{match:({type:e})=>e==="break",runner:(e,n,o)=>{var r;e.addNode(o,{isInline:!!((r=n.data)!=null&&r.isInline)})}},leafText:()=>`
`,toMarkdown:{match:e=>e.type.name==="hardbreak",runner:(e,n)=>{n.attrs.isInline?e.addNode("text",void 0,`
`):e.addNode("break")}}}));h(Be.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"});h(Be.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const nr=N("InsertHardbreak",t=>()=>(e,n)=>{var o;const{selection:r,tr:s}=e;if(!(r instanceof q))return!1;if(r.empty){const a=r.$from.node();if(a.childCount>0&&((o=a.lastChild)==null?void 0:o.type.name)==="hardbreak")return n==null||n(s.replaceRangeWith(r.to-1,r.to,e.schema.node("paragraph")).setSelection(K.near(s.doc.resolve(r.to))).scrollIntoView()),!0}return n==null||n(s.setMeta("hardbreak",!0).replaceSelectionWith(Be.type(t).create()).scrollIntoView()),!0});h(nr,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const or=j("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:t=>{const e=t.get(v);return()=>e.call(nr.key)}}});h(or.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"});h(or.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const rr=oe("hr");h(rr,{displayName:"Attr<hr>",group:"Hr"});const Xt=O("hr",t=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",t.get(rr.key)(e)],parseMarkdown:{match:({type:e})=>e==="thematicBreak",runner:(e,n,o)=>{e.addNode(o)}},toMarkdown:{match:e=>e.type.name==="hr",runner:e=>{e.addNode("thematicBreak")}}}));h(Xt.node,{displayName:"NodeSchema<hr>",group:"Hr"});h(Xt.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const ia=F(t=>new H(/^(?:---|___\s|\*\*\*\s)$/,(e,n,o,r)=>{const{tr:s}=e;return n[0]&&s.replaceWith(o-1,r,Xt.type(t).create()),s}));h(ia,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const la=N("InsertHr",t=>()=>(e,n)=>{if(!n)return!0;const o=Te.node.type(t).create(),{tr:r,selection:s}=e,{from:a}=s,i=Xt.type(t).create();if(!i)return!0;const l=r.replaceSelectionWith(i).insert(a,o),c=K.findFrom(l.doc.resolve(a),1,!0);return c&&n(l.setSelection(c).scrollIntoView()),!0});h(la,{displayName:"Command<insertHrCommand>",group:"Hr"});const sr=oe("bulletList");h(sr,{displayName:"Attr<bulletList>",group:"BulletList"});const ct=O("bullet_list",t=>({content:"listItem+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{tag:"ul",getAttrs:e=>{if(!(e instanceof HTMLElement))throw ue(e);return{spread:e.dataset.spread}}}],toDOM:e=>["ul",{...t.get(sr.key)(e),"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:n})=>e==="list"&&!n,runner:(e,n,o)=>{const r=n.spread!=null?`${n.spread}`:"false";e.openNode(o,{spread:r}).next(n.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="bullet_list",runner:(e,n)=>{e.openNode("list",void 0,{ordered:!1,spread:n.attrs.spread==="true"}).next(n.content).closeNode()}}}));h(ct.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"});h(ct.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const ca=F(t=>To(/^\s*([-+*])\s$/,ct.type(t)));h(ca,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const ar=N("WrapInBulletList",t=>()=>Ao(ct.type(t)));h(ar,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const ir=j("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:t=>{const e=t.get(v);return()=>e.call(ar.key)}}});h(ir.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"});h(ir.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const lr=oe("orderedList");h(lr,{displayName:"Attr<orderedList>",group:"OrderedList"});const dt=O("ordered_list",t=>({content:"listItem+",group:"block",attrs:{order:{default:1},spread:{default:!1}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw ue(e);return{spread:e.dataset.spread,order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",{...t.get(lr.key)(e),...e.attrs.order===1?{}:e.attrs.order,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:n})=>e==="list"&&!!n,runner:(e,n,o)=>{const r=n.spread!=null?`${n.spread}`:"true";e.openNode(o,{spread:r}).next(n.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="ordered_list",runner:(e,n)=>{e.openNode("list",void 0,{ordered:!0,start:1,spread:n.attrs.spread==="true"}),e.next(n.content),e.closeNode()}}}));h(dt.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"});h(dt.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const da=F(t=>To(/^\s*(\d+)\.\s$/,dt.type(t),e=>({order:Number(e[1])}),(e,n)=>n.childCount+n.attrs.order===Number(e[1])));h(da,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const cr=N("WrapInOrderedList",t=>()=>Ao(dt.type(t)));h(cr,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const dr=j("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:t=>{const e=t.get(v);return()=>e.call(cr.key)}}});h(dr.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"});h(dr.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const ur=oe("listItem");h(ur,{displayName:"Attr<listItem>",group:"ListItem"});const de=O("list_item",t=>({group:"listItem",content:"(paragraph|blockquote) block*",attrs:{label:{default:"•"},listType:{default:"bullet"},spread:{default:"true"}},defining:!0,parseDOM:[{tag:"li",getAttrs:e=>{if(!(e instanceof HTMLElement))throw ue(e);return{label:e.dataset.label,listType:e.dataset.listType,spread:e.dataset.spread}}}],toDOM:e=>["li",{...t.get(ur.key)(e),"data-label":e.attrs.label,"data-list-type":e.attrs.listType,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e})=>e==="listItem",runner:(e,n,o)=>{const r=n.label!=null?`${n.label}.`:"•",s=n.label!=null?"ordered":"bullet",a=n.spread!=null?`${n.spread}`:"true";e.openNode(o,{label:r,listType:s,spread:a}),e.next(n.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="list_item",runner:(e,n)=>{e.openNode("listItem",void 0,{spread:n.attrs.spread==="true"}),e.next(n.content),e.closeNode()}}}));h(de.node,{displayName:"NodeSchema<listItem>",group:"ListItem"});h(de.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const pr=N("SinkListItem",t=>()=>wi(de.type(t)));h(pr,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const hr=N("LiftListItem",t=>()=>gs(de.type(t)));h(hr,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const mr=N("SplitListItem",t=>()=>ki(de.type(t)));h(mr,{displayName:"Command<splitListItemCommand>",group:"ListItem"});function ql(t){return(e,n,o)=>{const{selection:r}=e;if(!(r instanceof q))return!1;const{empty:s,$from:a}=r;if(!s||a.parentOffset!==0)return!1;const i=a.node(-1);return i.type!==de.type(t)||i.firstChild!==a.node()||a.node(-2).childCount>1?!1:gs(de.type(t))(e,n,o)}}const fr=N("LiftFirstListItem",t=>()=>ql(t));h(fr,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const gr=j("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:t=>{const e=t.get(v);return()=>e.call(mr.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:t=>{const e=t.get(v);return()=>e.call(pr.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:t=>{const e=t.get(v);return()=>e.call(hr.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:t=>{const e=t.get(v);return()=>e.call(fr.key)}}});h(gr.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"});h(gr.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const ua=_o("text",()=>({group:"inline",parseMarkdown:{match:({type:t})=>t==="text",runner:(t,e)=>{t.addText(e.value)}},toMarkdown:{match:t=>t.type.name==="text",runner:(t,e)=>{t.addNode("text",void 0,e.text)}}}));h(ua,{displayName:"NodeSchema<text>",group:"Text"});const yr=oe("html");h(yr,{displayName:"Attr<html>",group:"Html"});const wr=O("html",t=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:""}},toDOM:e=>{const n=document.createElement("span"),o={...t.get(yr.key)(e),"data-value":e.attrs.value,"data-type":"html"};return n.textContent=e.attrs.value,["span",o,e.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:e=>({value:e.dataset.value??""})}],parseMarkdown:{match:({type:e})=>e==="html",runner:(e,n,o)=>{e.addNode(o,{value:n.value})}},toMarkdown:{match:e=>e.type.name==="html",runner:(e,n)=>{e.addNode("html",void 0,n.attrs.value)}}}));h(wr.node,{displayName:"NodeSchema<html>",group:"Html"});h(wr.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const Ul=[ta,zo,Te,Kn,qo,Fe,Wn,Be,Go,Jt,Qo,Gt,rr,Xt,tr,lt,sr,ct,lr,dt,ur,de,Eo,it,Do,Ut,Bo,xe,jo,nt,yr,wr,ua].flat(),Jl=[oa,ca,da,ra,ia,na].flat(),Gl=[Gs,Xs,Qs,Ys],Xl=[Ko,Xo,Ne,Uo,Zo,nr,la,sa,aa,cr,ar,pr,mr,hr,fr,Oo,Ho,Po,Zs,ea],Yl=[Yo,er,or,Jo,gr,dr,ir,Vo,Lo,Fo,Wo].flat(),kr=at("remarkAddOrderInList",()=>()=>t=>{zt(t,"list",e=>{if(e.ordered){const n=e.start??1;e.children.forEach((o,r)=>{o.label=r+n})}})});h(kr.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"});h(kr.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const br=at("remarkLineBreak",()=>()=>t=>{const e=/[\t ]*(?:\r?\n|\r)/g;zt(t,"text",(n,o,r)=>{if(!n.value||typeof n.value!="string")return;const s=[];let a=0;e.lastIndex=0;let i=e.exec(n.value);for(;i;){const l=i.index;a!==l&&s.push({type:"text",value:n.value.slice(a,l)}),s.push({type:"break",data:{isInline:!0}}),a=l+i[0].length,i=e.exec(n.value)}if(s.length>0&&r&&typeof o=="number")return a<n.value.length&&s.push({type:"text",value:n.value.slice(a)}),r.children.splice(o,1,...s),o+s.length})});h(br.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"});h(br.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const Cr=at("remarkInlineLink",()=>Fl);h(Cr.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"});h(Cr.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const Ql=t=>!!t.children,Zl=t=>t.type==="html";function ec(t,e){return n(t,0,null)[0];function n(o,r,s){if(Ql(o)){const a=[];for(let i=0,l=o.children.length;i<l;i++){const c=o.children[i];if(c){const d=n(c,i,o);if(d)for(let u=0,p=d.length;u<p;u++){const m=d[u];m&&a.push(m)}}}o.children=a}return e(o,r,s)}}const Nr=at("remarkHTMLTransformer",()=>()=>t=>{ec(t,(e,n,o)=>Zl(e)?((o==null?void 0:o.type)==="root"&&(e.children=[{...e}],delete e.value,e.type="paragraph"),[e]):[e])});h(Nr.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"});h(Nr.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const Mr=at("remarkMarker",()=>()=>(t,e)=>{const n=o=>e.value.charAt(o.position.start.offset);zt(t,o=>["strong","emphasis"].includes(o.type),o=>{o.marker=n(o)})});h(Mr.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"});h(Mr.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const pa=Y(()=>{let t=!1;const e=new P("MILKDOWN_INLINE_NODES_CURSOR"),n=new W({key:e,state:{init(){return!1},apply(o){if(!o.selection.empty)return!1;const r=o.selection.$from,s=r.nodeBefore,a=r.nodeAfter;return!!(s&&a&&s.isInline&&!s.isText&&a.isInline&&!a.isText)}},props:{handleDOMEvents:{compositionend:(o,r)=>t?(t=!1,requestAnimationFrame(()=>{if(n.getState(o.state)){const s=o.state.selection.from;r.preventDefault(),o.dispatch(o.state.tr.insertText(r.data||"",s))}}),!0):!1,compositionstart:o=>(n.getState(o.state)&&(t=!0),!1),beforeinput:(o,r)=>{if(n.getState(o.state)&&r instanceof InputEvent&&r.data&&!t){const s=o.state.selection.from;return r.preventDefault(),o.dispatch(o.state.tr.insertText(r.data||"",s)),!0}return!1}},decorations(o){if(n.getState(o)){const r=o.selection.$from.pos,s=document.createElement("span"),a=ot.widget(r,s,{side:-1}),i=document.createElement("span"),l=ot.widget(r,i);return setTimeout(()=>{s.contentEditable="true",i.contentEditable="true"}),rt.create(o.doc,[a,l])}return rt.empty}}});return n});h(pa,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const ha=Y(t=>new W({key:new P("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(e,n,o)=>{if(!e.length)return;const[r]=e;if(!r)return;const[s]=r.steps;if(r.getMeta("hardbreak")){if(!(s instanceof bi))return;const{from:a}=s;return o.tr.setNodeMarkup(a,Be.type(t),void 0,[])}if(s instanceof Ci){let a=o.tr;const{from:i,to:l}=s;return o.doc.nodesBetween(i,l,(c,d)=>{c.type===Be.type(t)&&(a=a.setNodeMarkup(d,Be.type(t),void 0,[]))}),a}}}));h(ha,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const $r=ne(["table","code_block"],"hardbreakFilterNodes");h($r,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const ma=Y(t=>{const e=t.get($r.key);return new W({key:new P("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(n,o)=>{const r=n.getMeta("hardbreak"),[s]=n.steps;if(r&&s){const{from:a}=s,i=o.doc.resolve(a);let l=i.depth,c=!0;for(;l>0;)e.includes(i.node(l).type.name)&&(c=!1),l--;return c}return!0}})});h(ma,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const fa=Y(t=>{const e=new P("MILKDOWN_HEADING_ID"),n=o=>{if(o.composing)return;const r=t.get(Kn.key),s=o.state.tr.setMeta("addToHistory",!1);let a=!1;const i={};o.state.doc.descendants((l,c)=>{if(l.type===Fe.type(t)){if(l.textContent.trim().length===0)return;const d=l.attrs;let u=r(l);i[u]?(i[u]+=1,u+=`-#${i[u]}`):i[u]=1,d.id!==u&&(a=!0,s.setMeta(e,!0).setNodeMarkup(c,void 0,{...d,id:u}))}}),a&&o.dispatch(s)};return new W({key:e,view:o=>(n(o),{update:(r,s)=>{r.state.doc.eq(s.doc)||n(r)}})})});h(fa,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const ga=Y(t=>{const e=n=>{if(n.composing||!n.editable)return;const o=dt.type(t),r=ct.type(t),s=de.type(t),a=n.state,i=(d,u)=>{let p=!1;const m=`${u+1}.`;return d.label!==m&&(d.label=m,p=!0),p};let l=a.tr,c=!1;a.doc.descendants((d,u,p,m)=>{if(d.type===r){const f=d.maybeChild(0);(f==null?void 0:f.type)===s&&f.attrs.listType==="ordered"&&(c=!0,l.setNodeMarkup(u,o,{spread:"true"}),d.descendants((w,C,b,D)=>{if(w.type===s){const _={...w.attrs};i(_,D)&&(l=l.setNodeMarkup(C,void 0,_))}return!1}))}else if(d.type===s&&(p==null?void 0:p.type)===o){const f={...d.attrs};let w=!1;f.listType!=="ordered"&&(f.listType="ordered",w=!0),p!=null&&p.maybeChild(0)&&(w=i(f,m)),w&&(l=l.setNodeMarkup(u,void 0,f),c=!0)}}),c&&n.dispatch(l.setMeta("addToHistory",!1))};return new W({key:new P("MILKDOWN_KEEP_LIST_ORDER"),view:n=>(e(n),{update:o=>{e(o)}})})});h(ga,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const tc=[ha,$r,ma,pa,kr,Cr,br,Nr,Mr,fa,ga].flat(),nc=[Ul,Jl,Gl,Xl,Yl,tc].flat();var Co,No;if(typeof WeakMap<"u"){let t=new WeakMap;Co=e=>t.get(e),No=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;Co=o=>{for(let r=0;r<t.length;r+=2)if(t[r]==o)return t[r+1]},No=(o,r)=>(n==10&&(n=0),t[n++]=o,t[n++]=r)}var S=class{constructor(t,e,n,o){this.width=t,this.height=e,this.map=n,this.problems=o}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const o=e%this.width,r=e/this.width|0;let s=o+1,a=r+1;for(let i=1;s<this.width&&this.map[e+i]==n;i++)s++;for(let i=1;a<this.height&&this.map[e+this.width*i]==n;i++)a++;return{left:o,top:r,right:s,bottom:a}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:o,right:r,top:s,bottom:a}=this.findCell(t);return e=="horiz"?(n<0?o==0:r==this.width)?null:this.map[s*this.width+(n<0?o-1:r)]:(n<0?s==0:a==this.height)?null:this.map[o+this.width*(n<0?s-1:a)]}rectBetween(t,e){const{left:n,right:o,top:r,bottom:s}=this.findCell(t),{left:a,right:i,top:l,bottom:c}=this.findCell(e);return{left:Math.min(n,a),top:Math.min(r,l),right:Math.max(o,i),bottom:Math.max(s,c)}}cellsInRect(t){const e=[],n={};for(let o=t.top;o<t.bottom;o++)for(let r=t.left;r<t.right;r++){const s=o*this.width+r,a=this.map[s];n[a]||(n[a]=!0,!(r==t.left&&r&&this.map[s-1]==a||o==t.top&&o&&this.map[s-this.width]==a)&&e.push(a))}return e}positionAt(t,e,n){for(let o=0,r=0;;o++){const s=r+n.child(o).nodeSize;if(o==t){let a=e+t*this.width;const i=(t+1)*this.width;for(;a<i&&this.map[a]<r;)a++;return a==i?s-1:this.map[a]}r=s}}static get(t){return Co(t)||No(t,oc(t))}};function oc(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=rc(t),n=t.childCount,o=[];let r=0,s=null;const a=[];for(let c=0,d=e*n;c<d;c++)o[c]=0;for(let c=0,d=0;c<n;c++){const u=t.child(c);d++;for(let f=0;;f++){for(;r<o.length&&o[r]!=0;)r++;if(f==u.childCount)break;const w=u.child(f),{colspan:C,rowspan:b,colwidth:D}=w.attrs;for(let _=0;_<b;_++){if(_+c>=n){(s||(s=[])).push({type:"overlong_rowspan",pos:d,n:b-_});break}const pe=r+_*e;for(let re=0;re<C;re++){o[pe+re]==0?o[pe+re]=d:(s||(s=[])).push({type:"collision",row:c,pos:d,n:C-re});const je=D&&D[re];if(je){const ht=(pe+re)%e*2,Gn=a[ht];Gn==null||Gn!=je&&a[ht+1]==1?(a[ht]=je,a[ht+1]=1):Gn==je&&a[ht+1]++}}}r+=C,d+=w.nodeSize}const p=(c+1)*e;let m=0;for(;r<p;)o[r++]==0&&m++;m&&(s||(s=[])).push({type:"missing",row:c,n:m}),d++}const i=new S(e,n,o,s);let l=!1;for(let c=0;!l&&c<a.length;c+=2)a[c]!=null&&a[c+1]<n&&(l=!0);return l&&sc(i,a,t),i}function rc(t){let e=-1,n=!1;for(let o=0;o<t.childCount;o++){const r=t.child(o);let s=0;if(n)for(let a=0;a<o;a++){const i=t.child(a);for(let l=0;l<i.childCount;l++){const c=i.child(l);a+c.attrs.rowspan>o&&(s+=c.attrs.colspan)}}for(let a=0;a<r.childCount;a++){const i=r.child(a);s+=i.attrs.colspan,i.attrs.rowspan>1&&(n=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function sc(t,e,n){t.problems||(t.problems=[]);const o={};for(let r=0;r<t.map.length;r++){const s=t.map[r];if(o[s])continue;o[s]=!0;const a=n.nodeAt(s);if(!a)throw new RangeError(`No cell with offset ${s} found`);let i=null;const l=a.attrs;for(let c=0;c<l.colspan;c++){const d=(r+c)%t.width,u=e[d*2];u!=null&&(!l.colwidth||l.colwidth[c]!=u)&&((i||(i=ac(l)))[c]=u)}i&&t.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:i})}}function ac(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function Zr(t,e){if(typeof t=="string")return{};const n=t.getAttribute("data-colwidth"),o=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map(a=>Number(a)):null,r=Number(t.getAttribute("colspan")||1),s={colspan:r,rowspan:Number(t.getAttribute("rowspan")||1),colwidth:o&&o.length==r?o:null};for(const a in e){const i=e[a].getFromDOM,l=i&&i(t);l!=null&&(s[a]=l)}return s}function es(t,e){const n={};t.attrs.colspan!=1&&(n.colspan=t.attrs.colspan),t.attrs.rowspan!=1&&(n.rowspan=t.attrs.rowspan),t.attrs.colwidth&&(n["data-colwidth"]=t.attrs.colwidth.join(","));for(const o in e){const r=e[o].setDOMAttr;r&&r(t.attrs[o],n)}return n}function ic(t){const e=t.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(const o in e)n[o]={default:e[o].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:t.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:t.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:o=>Zr(o,e)}],toDOM(o){return["td",es(o,e),0]}},table_header:{content:t.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:o=>Zr(o,e)}],toDOM(o){return["th",es(o,e),0]}}}}function X(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const o=t.nodes[n],r=o.spec.tableRole;r&&(e[r]=o)}}return e}var Me=new P("selectingCells");function Yt(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function Q(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function Vn(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=Yt(e.$head)||lc(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function lc(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const o=e.type.spec.tableRole;if(o=="cell"||o=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const o=e.type.spec.tableRole;if(o=="cell"||o=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function Mo(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function cc(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function xr(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function ya(t,e,n){const o=t.node(-1),r=S.get(o),s=t.start(-1),a=r.nextCell(t.pos-s,e,n);return a==null?null:t.node(0).resolve(s+a)}function He(t,e,n=1){const o={...t,colspan:t.colspan-n};return o.colwidth&&(o.colwidth=o.colwidth.slice(),o.colwidth.splice(e,n),o.colwidth.some(r=>r>0)||(o.colwidth=null)),o}function dc(t,e,n=1){const o={...t,colspan:t.colspan+n};if(o.colwidth){o.colwidth=o.colwidth.slice();for(let r=0;r<n;r++)o.colwidth.splice(e,0,0)}return o}function uc(t,e,n){const o=X(e.type.schema).header_cell;for(let r=0;r<t.height;r++)if(e.nodeAt(t.map[n+r*t.width]).type!=o)return!1;return!0}var I=class me extends K{constructor(e,n=e){const o=e.node(-1),r=S.get(o),s=e.start(-1),a=r.rectBetween(e.pos-s,n.pos-s),i=e.node(0),l=r.cellsInRect(a).filter(d=>d!=n.pos-s);l.unshift(n.pos-s);const c=l.map(d=>{const u=o.nodeAt(d);if(!u)throw RangeError(`No cell with offset ${d} found`);const p=s+d+1;return new Ni(i.resolve(p),i.resolve(p+u.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=n}map(e,n){const o=e.resolve(n.map(this.$anchorCell.pos)),r=e.resolve(n.map(this.$headCell.pos));if(Mo(o)&&Mo(r)&&xr(o,r)){const s=this.$anchorCell.node(-1)!=o.node(-1);return s&&this.isRowSelection()?me.rowSelection(o,r):s&&this.isColSelection()?me.colSelection(o,r):new me(o,r)}return q.between(o,r)}content(){const e=this.$anchorCell.node(-1),n=S.get(e),o=this.$anchorCell.start(-1),r=n.rectBetween(this.$anchorCell.pos-o,this.$headCell.pos-o),s={},a=[];for(let l=r.top;l<r.bottom;l++){const c=[];for(let d=l*n.width+r.left,u=r.left;u<r.right;u++,d++){const p=n.map[d];if(s[p])continue;s[p]=!0;const m=n.findCell(p);let f=e.nodeAt(p);if(!f)throw RangeError(`No cell with offset ${p} found`);const w=r.left-m.left,C=m.right-r.right;if(w>0||C>0){let b=f.attrs;if(w>0&&(b=He(b,0,w)),C>0&&(b=He(b,b.colspan-C,C)),m.left<r.left){if(f=f.type.createAndFill(b),!f)throw RangeError(`Could not create cell with attrs ${JSON.stringify(b)}`)}else f=f.type.create(b,f.content)}if(m.top<r.top||m.bottom>r.bottom){const b={...f.attrs,rowspan:Math.min(m.bottom,r.bottom)-Math.max(m.top,r.top)};m.top<r.top?f=f.type.createAndFill(b):f=f.type.create(b,f.content)}c.push(f)}a.push(e.child(l).copy(le.from(c)))}const i=this.isColSelection()&&this.isRowSelection()?e:a;return new $e(le.from(i),1,1)}replace(e,n=$e.empty){const o=e.steps.length,r=this.ranges;for(let a=0;a<r.length;a++){const{$from:i,$to:l}=r[a],c=e.mapping.slice(o);e.replace(c.map(i.pos),c.map(l.pos),a?$e.empty:n)}const s=K.findFrom(e.doc.resolve(e.mapping.slice(o).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,n){this.replace(e,new $e(le.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),o=S.get(n),r=this.$anchorCell.start(-1),s=o.cellsInRect(o.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let a=0;a<s.length;a++)e(n.nodeAt(s[a]),r+s[a])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const o=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(o,r)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const o=e.node(-1),r=S.get(o),s=e.start(-1),a=r.findCell(e.pos-s),i=r.findCell(n.pos-s),l=e.node(0);return a.top<=i.top?(a.top>0&&(e=l.resolve(s+r.map[a.left])),i.bottom<r.height&&(n=l.resolve(s+r.map[r.width*(r.height-1)+i.right-1]))):(i.top>0&&(n=l.resolve(s+r.map[i.left])),a.bottom<r.height&&(e=l.resolve(s+r.map[r.width*(r.height-1)+a.right-1]))),new me(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=S.get(e),o=this.$anchorCell.start(-1),r=n.colCount(this.$anchorCell.pos-o),s=n.colCount(this.$headCell.pos-o);if(Math.min(r,s)>0)return!1;const a=r+this.$anchorCell.nodeAfter.attrs.colspan,i=s+this.$headCell.nodeAfter.attrs.colspan;return Math.max(a,i)==n.width}eq(e){return e instanceof me&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const o=e.node(-1),r=S.get(o),s=e.start(-1),a=r.findCell(e.pos-s),i=r.findCell(n.pos-s),l=e.node(0);return a.left<=i.left?(a.left>0&&(e=l.resolve(s+r.map[a.top*r.width])),i.right<r.width&&(n=l.resolve(s+r.map[r.width*(i.top+1)-1]))):(i.left>0&&(n=l.resolve(s+r.map[i.top*r.width])),a.right<r.width&&(e=l.resolve(s+r.map[r.width*(a.top+1)-1]))),new me(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new me(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,o=n){return new me(e.resolve(n),e.resolve(o))}getBookmark(){return new pc(this.$anchorCell.pos,this.$headCell.pos)}};I.prototype.visible=!1;K.jsonID("cell",I);var pc=class wa{constructor(e,n){this.anchor=e,this.head=n}map(e){return new wa(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),o=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&o.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&o.index()<o.parent.childCount&&xr(n,o)?new I(n,o):K.near(o,1)}};function hc(t){if(!(t.selection instanceof I))return null;const e=[];return t.selection.forEachCell((n,o)=>{e.push(ot.node(o,o+n.nodeSize,{class:"selectedCell"}))}),rt.create(t.doc,e)}function mc({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,o=e.pos,r=t.depth;for(;r>=0&&!(t.after(r+1)<t.end(r));r--,n++);for(let s=e.depth;s>=0&&!(e.before(s+1)>e.start(s));s--,o--);return n==o&&/row|table/.test(t.node(r).type.spec.tableRole)}function fc({$from:t,$to:e}){let n,o;for(let r=t.depth;r>0;r--){const s=t.node(r);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){n=s;break}}for(let r=e.depth;r>0;r--){const s=e.node(r);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){o=s;break}}return n!==o&&e.parentOffset===0}function gc(t,e,n){const o=(e||t).selection,r=(e||t).doc;let s,a;if(o instanceof hs&&(a=o.node.type.spec.tableRole)){if(a=="cell"||a=="header_cell")s=I.create(r,o.from);else if(a=="row"){const i=r.resolve(o.from+1);s=I.rowSelection(i,i)}else if(!n){const i=S.get(o.node),l=o.from+1,c=l+i.map[i.width*i.height-1];s=I.create(r,l+1,c)}}else o instanceof q&&mc(o)?s=q.create(r,o.from):o instanceof q&&fc(o)&&(s=q.create(r,o.$from.start(),o.$from.end()));return s&&(e||(e=t.tr)).setSelection(s),e}var yc=new P("fix-tables");function ka(t,e,n,o){const r=t.childCount,s=e.childCount;e:for(let a=0,i=0;a<s;a++){const l=e.child(a);for(let c=i,d=Math.min(r,a+3);c<d;c++)if(t.child(c)==l){i=c+1,n+=l.nodeSize;continue e}o(l,n),i<r&&t.child(i).sameMarkup(l)?ka(t.child(i),l,n+1,o):l.nodesBetween(0,l.content.size,o,n+1),n+=l.nodeSize}}function wc(t,e){let n;const o=(r,s)=>{r.type.spec.tableRole=="table"&&(n=kc(t,r,s,n))};return e?e.doc!=t.doc&&ka(e.doc,t.doc,0,o):t.doc.descendants(o),n}function kc(t,e,n,o){const r=S.get(e);if(!r.problems)return o;o||(o=t.tr);const s=[];for(let l=0;l<r.height;l++)s.push(0);for(let l=0;l<r.problems.length;l++){const c=r.problems[l];if(c.type=="collision"){const d=e.nodeAt(c.pos);if(!d)continue;const u=d.attrs;for(let p=0;p<u.rowspan;p++)s[c.row+p]+=c.n;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,He(u,u.colspan-c.n,c.n))}else if(c.type=="missing")s[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const d=e.nodeAt(c.pos);if(!d)continue;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,{...d.attrs,rowspan:d.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const d=e.nodeAt(c.pos);if(!d)continue;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,{...d.attrs,colwidth:c.colwidth})}}let a,i;for(let l=0;l<s.length;l++)s[l]&&(a==null&&(a=l),i=l);for(let l=0,c=n+1;l<r.height;l++){const d=e.child(l),u=c+d.nodeSize,p=s[l];if(p>0){let m="cell";d.firstChild&&(m=d.firstChild.type.spec.tableRole);const f=[];for(let C=0;C<p;C++){const b=X(t.schema)[m].createAndFill();b&&f.push(b)}const w=(l==0||a==l-1)&&i==l?c+1:u-1;o.insert(o.mapping.map(w),f)}c=u}return o.setMeta(yc,{fixTables:!0})}function Re(t){const e=t.selection,n=Vn(t),o=n.node(-1),r=n.start(-1),s=S.get(o);return{...e instanceof I?s.rectBetween(e.$anchorCell.pos-r,e.$headCell.pos-r):s.findCell(n.pos-r),tableStart:r,map:s,table:o}}function ba(t,{map:e,tableStart:n,table:o},r){let s=r>0?-1:0;uc(e,o,r+s)&&(s=r==0||r==e.width?null:0);for(let a=0;a<e.height;a++){const i=a*e.width+r;if(r>0&&r<e.width&&e.map[i-1]==e.map[i]){const l=e.map[i],c=o.nodeAt(l);t.setNodeMarkup(t.mapping.map(n+l),null,dc(c.attrs,r-e.colCount(l))),a+=c.attrs.rowspan-1}else{const l=s==null?X(o.type.schema).cell:o.nodeAt(e.map[i+s]).type,c=e.positionAt(a,r,o);t.insert(t.mapping.map(n+c),l.createAndFill())}}return t}function bc(t,e){if(!Q(t))return!1;if(e){const n=Re(t);e(ba(t.tr,n,n.left))}return!0}function Cc(t,e){if(!Q(t))return!1;if(e){const n=Re(t);e(ba(t.tr,n,n.right))}return!0}function Nc(t,{map:e,table:n,tableStart:o},r){const s=t.mapping.maps.length;for(let a=0;a<e.height;){const i=a*e.width+r,l=e.map[i],c=n.nodeAt(l),d=c.attrs;if(r>0&&e.map[i-1]==l||r<e.width-1&&e.map[i+1]==l)t.setNodeMarkup(t.mapping.slice(s).map(o+l),null,He(d,r-e.colCount(l)));else{const u=t.mapping.slice(s).map(o+l);t.delete(u,u+c.nodeSize)}a+=d.rowspan}}function Mc(t,e){if(!Q(t))return!1;if(e){const n=Re(t),o=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let r=n.right-1;Nc(o,n,r),r!=n.left;r--){const s=n.tableStart?o.doc.nodeAt(n.tableStart-1):o.doc;if(!s)throw RangeError("No table found");n.table=s,n.map=S.get(s)}e(o)}return!0}function $c(t,{map:e,table:n,tableStart:o},r){let s=0;for(let c=0;c<r;c++)s+=n.child(c).nodeSize;const a=s+n.child(r).nodeSize,i=t.mapping.maps.length;t.delete(s+o,a+o);const l=new Set;for(let c=0,d=r*e.width;c<e.width;c++,d++){const u=e.map[d];if(!l.has(u)){if(l.add(u),r>0&&u==e.map[d-e.width]){const p=n.nodeAt(u).attrs;t.setNodeMarkup(t.mapping.slice(i).map(u+o),null,{...p,rowspan:p.rowspan-1}),c+=p.colspan-1}else if(r<e.height&&u==e.map[d+e.width]){const p=n.nodeAt(u),m=p.attrs,f=p.type.create({...m,rowspan:p.attrs.rowspan-1},p.content),w=e.positionAt(r+1,c,n);t.insert(t.mapping.slice(i).map(o+w),f),c+=m.colspan-1}}}}function xc(t,e){if(!Q(t))return!1;if(e){const n=Re(t),o=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let r=n.bottom-1;$c(o,n,r),r!=n.top;r--){const s=n.tableStart?o.doc.nodeAt(n.tableStart-1):o.doc;if(!s)throw RangeError("No table found");n.table=s,n.map=S.get(n.table)}e(o)}return!0}function vc(t,e){return function(n,o){if(!Q(n))return!1;const r=Vn(n);if(r.nodeAfter.attrs[t]===e)return!1;if(o){const s=n.tr;n.selection instanceof I?n.selection.forEachCell((a,i)=>{a.attrs[t]!==e&&s.setNodeMarkup(i,null,{...a.attrs,[t]:e})}):s.setNodeMarkup(r.pos,null,{...r.nodeAfter.attrs,[t]:e}),o(s)}return!0}}function Sc(t){return function(e,n){if(!Q(e))return!1;if(n){const o=X(e.schema),r=Re(e),s=e.tr,a=r.map.cellsInRect(t=="column"?{left:r.left,top:0,right:r.right,bottom:r.map.height}:t=="row"?{left:0,top:r.top,right:r.map.width,bottom:r.bottom}:r),i=a.map(l=>r.table.nodeAt(l));for(let l=0;l<a.length;l++)i[l].type==o.header_cell&&s.setNodeMarkup(r.tableStart+a[l],o.cell,i[l].attrs);if(s.steps.length==0)for(let l=0;l<a.length;l++)s.setNodeMarkup(r.tableStart+a[l],o.header_cell,i[l].attrs);n(s)}return!0}}function ts(t,e,n){const o=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let r=0;r<o.length;r++){const s=e.table.nodeAt(o[r]);if(s&&s.type!==n.header_cell)return!1}return!0}function vr(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?Sc(t):function(n,o){if(!Q(n))return!1;if(o){const r=X(n.schema),s=Re(n),a=n.tr,i=ts("row",s,r),l=ts("column",s,r),d=(t==="column"?i:t==="row"?l:!1)?1:0,u=t=="column"?{left:0,top:d,right:1,bottom:s.map.height}:t=="row"?{left:d,top:0,right:s.map.width,bottom:1}:s,p=t=="column"?l?r.cell:r.header_cell:t=="row"?i?r.cell:r.header_cell:r.cell;s.map.cellsInRect(u).forEach(m=>{const f=m+s.tableStart,w=a.doc.nodeAt(f);w&&a.setNodeMarkup(f,p,w.attrs)}),o(a)}return!0}}vr("row",{useDeprecatedLogic:!0});vr("column",{useDeprecatedLogic:!0});vr("cell",{useDeprecatedLogic:!0});function Ac(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let o=t.index(-1)-1,r=t.before();o>=0;o--){const s=t.node(-1).child(o),a=s.lastChild;if(a)return r-1-a.nodeSize;r-=s.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let o=t.indexAfter(-1),r=t.after();o<n.childCount;o++){const s=n.child(o);if(s.childCount)return r+1;r+=s.nodeSize}}return null}function Ca(t){return function(e,n){if(!Q(e))return!1;const o=Ac(Vn(e),t);if(o==null)return!1;if(n){const r=e.doc.resolve(o);n(e.tr.setSelection(q.between(r,cc(r))).scrollIntoView())}return!0}}function Ic(t,e){const n=t.selection.$anchor;for(let o=n.depth;o>0;o--)if(n.node(o).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(o),n.after(o)).scrollIntoView()),!0;return!1}function on(t,e){const n=t.selection;if(!(n instanceof I))return!1;if(e){const o=t.tr,r=X(t.schema).cell.createAndFill().content;n.forEachCell((s,a)=>{s.content.eq(r)||o.replace(o.mapping.map(a+1),o.mapping.map(a+s.nodeSize-1),new $e(r,0,0))}),o.docChanged&&e(o)}return!0}function Tc(t){if(!t.size)return null;let{content:e,openStart:n,openEnd:o}=t;for(;e.childCount==1&&(n>0&&o>0||e.child(0).type.spec.tableRole=="table");)n--,o--,e=e.child(0).content;const r=e.child(0),s=r.type.spec.tableRole,a=r.type.schema,i=[];if(s=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const d=l?0:Math.max(0,n-1),u=l<e.childCount-1?0:Math.max(0,o-1);(d||u)&&(c=$o(X(a).row,new $e(c,d,u)).content),i.push(c)}else if(s=="cell"||s=="header_cell")i.push(n||o?$o(X(a).row,new $e(e,n,o)).content:e);else return null;return Rc(a,i)}function Rc(t,e){const n=[];for(let r=0;r<e.length;r++){const s=e[r];for(let a=s.childCount-1;a>=0;a--){const{rowspan:i,colspan:l}=s.child(a).attrs;for(let c=r;c<r+i;c++)n[c]=(n[c]||0)+l}}let o=0;for(let r=0;r<n.length;r++)o=Math.max(o,n[r]);for(let r=0;r<n.length;r++)if(r>=e.length&&e.push(le.empty),n[r]<o){const s=X(t).cell.createAndFill(),a=[];for(let i=n[r];i<o;i++)a.push(s);e[r]=e[r].append(le.from(a))}return{height:e.length,width:o,rows:e}}function $o(t,e){const n=t.createAndFill();return new $i(n).replace(0,n.content.size,e).doc}function _c({width:t,height:e,rows:n},o,r){if(t!=o){const s=[],a=[];for(let i=0;i<n.length;i++){const l=n[i],c=[];for(let d=s[i]||0,u=0;d<o;u++){let p=l.child(u%l.childCount);d+p.attrs.colspan>o&&(p=p.type.createChecked(He(p.attrs,p.attrs.colspan,d+p.attrs.colspan-o),p.content)),c.push(p),d+=p.attrs.colspan;for(let m=1;m<p.attrs.rowspan;m++)s[i+m]=(s[i+m]||0)+p.attrs.colspan}a.push(le.from(c))}n=a,t=o}if(e!=r){const s=[];for(let a=0,i=0;a<r;a++,i++){const l=[],c=n[i%e];for(let d=0;d<c.childCount;d++){let u=c.child(d);a+u.attrs.rowspan>r&&(u=u.type.create({...u.attrs,rowspan:Math.max(1,r-u.attrs.rowspan)},u.content)),l.push(u)}s.push(le.from(l))}n=s,e=r}return{width:t,height:e,rows:n}}function Ec(t,e,n,o,r,s,a){const i=t.doc.type.schema,l=X(i);let c,d;if(r>e.width)for(let u=0,p=0;u<e.height;u++){const m=n.child(u);p+=m.nodeSize;const f=[];let w;m.lastChild==null||m.lastChild.type==l.cell?w=c||(c=l.cell.createAndFill()):w=d||(d=l.header_cell.createAndFill());for(let C=e.width;C<r;C++)f.push(w);t.insert(t.mapping.slice(a).map(p-1+o),f)}if(s>e.height){const u=[];for(let f=0,w=(e.height-1)*e.width;f<Math.max(e.width,r);f++){const C=f>=e.width?!1:n.nodeAt(e.map[w+f]).type==l.header_cell;u.push(C?d||(d=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const p=l.row.create(null,le.from(u)),m=[];for(let f=e.height;f<s;f++)m.push(p);t.insert(t.mapping.slice(a).map(o+n.nodeSize-2),m)}return!!(c||d)}function ns(t,e,n,o,r,s,a,i){if(a==0||a==e.height)return!1;let l=!1;for(let c=r;c<s;c++){const d=a*e.width+c,u=e.map[d];if(e.map[d-e.width]==u){l=!0;const p=n.nodeAt(u),{top:m,left:f}=e.findCell(u);t.setNodeMarkup(t.mapping.slice(i).map(u+o),null,{...p.attrs,rowspan:a-m}),t.insert(t.mapping.slice(i).map(e.positionAt(a,f,n)),p.type.createAndFill({...p.attrs,rowspan:m+p.attrs.rowspan-a})),c+=p.attrs.colspan-1}}return l}function os(t,e,n,o,r,s,a,i){if(a==0||a==e.width)return!1;let l=!1;for(let c=r;c<s;c++){const d=c*e.width+a,u=e.map[d];if(e.map[d-1]==u){l=!0;const p=n.nodeAt(u),m=e.colCount(u),f=t.mapping.slice(i).map(u+o);t.setNodeMarkup(f,null,He(p.attrs,a-m,p.attrs.colspan-(a-m))),t.insert(f+p.nodeSize,p.type.createAndFill(He(p.attrs,0,a-m))),c+=p.attrs.rowspan-1}}return l}function rs(t,e,n,o,r){let s=n?t.doc.nodeAt(n-1):t.doc;if(!s)throw new Error("No table found");let a=S.get(s);const{top:i,left:l}=o,c=l+r.width,d=i+r.height,u=t.tr;let p=0;function m(){if(s=n?u.doc.nodeAt(n-1):u.doc,!s)throw new Error("No table found");a=S.get(s),p=u.mapping.maps.length}Ec(u,a,s,n,c,d,p)&&m(),ns(u,a,s,n,l,c,i,p)&&m(),ns(u,a,s,n,l,c,d,p)&&m(),os(u,a,s,n,i,d,l,p)&&m(),os(u,a,s,n,i,d,c,p)&&m();for(let f=i;f<d;f++){const w=a.positionAt(f,l,s),C=a.positionAt(f,c,s);u.replace(u.mapping.slice(p).map(w+n),u.mapping.slice(p).map(C+n),new $e(r.rows[f-i],0,0))}m(),u.setSelection(new I(u.doc.resolve(n+a.positionAt(i,l,s)),u.doc.resolve(n+a.positionAt(d-1,c-1,s)))),e(u)}var Oc=Mi({ArrowLeft:rn("horiz",-1),ArrowRight:rn("horiz",1),ArrowUp:rn("vert",-1),ArrowDown:rn("vert",1),"Shift-ArrowLeft":sn("horiz",-1),"Shift-ArrowRight":sn("horiz",1),"Shift-ArrowUp":sn("vert",-1),"Shift-ArrowDown":sn("vert",1),Backspace:on,"Mod-Backspace":on,Delete:on,"Mod-Delete":on});function On(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function rn(t,e){return(n,o,r)=>{if(!r)return!1;const s=n.selection;if(s instanceof I)return On(n,o,K.near(s.$headCell,e));if(t!="horiz"&&!s.empty)return!1;const a=Na(r,t,e);if(a==null)return!1;if(t=="horiz")return On(n,o,K.near(n.doc.resolve(s.head+e),e));{const i=n.doc.resolve(a),l=ya(i,t,e);let c;return l?c=K.near(l,1):e<0?c=K.near(n.doc.resolve(i.before(-1)),-1):c=K.near(n.doc.resolve(i.after(-1)),1),On(n,o,c)}}}function sn(t,e){return(n,o,r)=>{if(!r)return!1;const s=n.selection;let a;if(s instanceof I)a=s;else{const l=Na(r,t,e);if(l==null)return!1;a=new I(n.doc.resolve(l))}const i=ya(a.$headCell,t,e);return i?On(n,o,new I(a.$anchorCell,i)):!1}}function Lc(t,e){const n=t.state.doc,o=Yt(n.resolve(e));return o?(t.dispatch(t.state.tr.setSelection(new I(o))),!0):!1}function Dc(t,e,n){if(!Q(t.state))return!1;let o=Tc(n);const r=t.state.selection;if(r instanceof I){o||(o={width:1,height:1,rows:[le.from($o(X(t.state.schema).cell,n))]});const s=r.$anchorCell.node(-1),a=r.$anchorCell.start(-1),i=S.get(s).rectBetween(r.$anchorCell.pos-a,r.$headCell.pos-a);return o=_c(o,i.right-i.left,i.bottom-i.top),rs(t.state,t.dispatch,a,i,o),!0}else if(o){const s=Vn(t.state),a=s.start(-1);return rs(t.state,t.dispatch,a,S.get(s.node(-1)).findCell(s.pos-a),o),!0}else return!1}function Pc(t,e){var n;if(e.ctrlKey||e.metaKey)return;const o=ss(t,e.target);let r;if(e.shiftKey&&t.state.selection instanceof I)s(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&o&&(r=Yt(t.state.selection.$anchor))!=null&&((n=ao(t,e))==null?void 0:n.pos)!=r.pos)s(r,e),e.preventDefault();else if(!o)return;function s(l,c){let d=ao(t,c);const u=Me.getState(t.state)==null;if(!d||!xr(l,d))if(u)d=l;else return;const p=new I(l,d);if(u||!t.state.selection.eq(p)){const m=t.state.tr.setSelection(p);u&&m.setMeta(Me,l.pos),t.dispatch(m)}}function a(){t.root.removeEventListener("mouseup",a),t.root.removeEventListener("dragstart",a),t.root.removeEventListener("mousemove",i),Me.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(Me,-1))}function i(l){const c=l,d=Me.getState(t.state);let u;if(d!=null)u=t.state.doc.resolve(d);else if(ss(t,c.target)!=o&&(u=ao(t,e),!u))return a();u&&s(u,c)}t.root.addEventListener("mouseup",a),t.root.addEventListener("dragstart",a),t.root.addEventListener("mousemove",i)}function Na(t,e,n){if(!(t.state.selection instanceof q))return null;const{$head:o}=t.state.selection;for(let r=o.depth-1;r>=0;r--){const s=o.node(r);if((n<0?o.index(r):o.indexAfter(r))!=(n<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){const i=o.before(r),l=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(l)?i:null}}return null}function ss(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function ao(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});return n&&n?Yt(t.state.doc.resolve(n.pos)):null}var Wc=class{constructor(t,e){this.node=t,this.defaultCellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${e}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),xo(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!=this.node.type?!1:(this.node=t,xo(t,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(t){return t.type=="attributes"&&(t.target==this.table||this.colgroup.contains(t.target))}};function xo(t,e,n,o,r,s){var a;let i=0,l=!0,c=e.firstChild;const d=t.firstChild;if(d){for(let u=0,p=0;u<d.childCount;u++){const{colspan:m,colwidth:f}=d.child(u).attrs;for(let w=0;w<m;w++,p++){const C=r==p?s:f&&f[w],b=C?C+"px":"";if(i+=C||o,C||(l=!1),c)c.style.width!=b&&(c.style.width=b),c=c.nextSibling;else{const D=document.createElement("col");D.style.width=b,e.appendChild(D)}}}for(;c;){const u=c.nextSibling;(a=c.parentNode)==null||a.removeChild(c),c=u}l?(n.style.width=i+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=i+"px")}}var V=new P("tableColumnResizing");function Bc({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:o=Wc,lastColumnResizable:r=!0}={}){const s=new W({key:V,state:{init(a,i){var l,c;const d=(c=(l=s.spec)==null?void 0:l.props)==null?void 0:c.nodeViews,u=X(i.schema).table.name;return o&&d&&(d[u]=(p,m)=>new o(p,n,m)),new Hc(-1,!1)},apply(a,i){return i.apply(a)}},props:{attributes:a=>{const i=V.getState(a);return i&&i.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(a,i)=>{Fc(a,i,t,r)},mouseleave:a=>{jc(a)},mousedown:(a,i)=>{zc(a,i,e,n)}},decorations:a=>{const i=V.getState(a);if(i&&i.activeHandle>-1)return Jc(a,i.activeHandle)},nodeViews:{}}});return s}var Hc=class Ln{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){const n=this,o=e.getMeta(V);if(o&&o.setHandle!=null)return new Ln(o.setHandle,!1);if(o&&o.setDragging!==void 0)return new Ln(n.activeHandle,o.setDragging);if(n.activeHandle>-1&&e.docChanged){let r=e.mapping.map(n.activeHandle,-1);return Mo(e.doc.resolve(r))||(r=-1),new Ln(r,n.dragging)}return n}};function Fc(t,e,n,o){if(!t.editable)return;const r=V.getState(t.state);if(r&&!r.dragging){const s=Vc(e.target);let a=-1;if(s){const{left:i,right:l}=s.getBoundingClientRect();e.clientX-i<=n?a=as(t,e,"left",n):l-e.clientX<=n&&(a=as(t,e,"right",n))}if(a!=r.activeHandle){if(!o&&a!==-1){const i=t.state.doc.resolve(a),l=i.node(-1),c=S.get(l),d=i.start(-1);if(c.colCount(i.pos-d)+i.nodeAfter.attrs.colspan-1==c.width-1)return}Ma(t,a)}}}function jc(t){if(!t.editable)return;const e=V.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&Ma(t,-1)}function zc(t,e,n,o){var r;if(!t.editable)return!1;const s=(r=t.dom.ownerDocument.defaultView)!=null?r:window,a=V.getState(t.state);if(!a||a.activeHandle==-1||a.dragging)return!1;const i=t.state.doc.nodeAt(a.activeHandle),l=Kc(t,a.activeHandle,i.attrs);t.dispatch(t.state.tr.setMeta(V,{setDragging:{startX:e.clientX,startWidth:l}}));function c(u){s.removeEventListener("mouseup",c),s.removeEventListener("mousemove",d);const p=V.getState(t.state);p!=null&&p.dragging&&(qc(t,p.activeHandle,is(p.dragging,u,n)),t.dispatch(t.state.tr.setMeta(V,{setDragging:null})))}function d(u){if(!u.which)return c(u);const p=V.getState(t.state);if(p&&p.dragging){const m=is(p.dragging,u,n);ls(t,p.activeHandle,m,o)}}return ls(t,a.activeHandle,l,o),s.addEventListener("mouseup",c),s.addEventListener("mousemove",d),e.preventDefault(),!0}function Kc(t,e,{colspan:n,colwidth:o}){const r=o&&o[o.length-1];if(r)return r;const s=t.domAtPos(e);let i=s.node.childNodes[s.offset].offsetWidth,l=n;if(o)for(let c=0;c<n;c++)o[c]&&(i-=o[c],l--);return i/l}function Vc(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function as(t,e,n,o){const r=n=="right"?-o:o,s=t.posAtCoords({left:e.clientX+r,top:e.clientY});if(!s)return-1;const{pos:a}=s,i=Yt(t.state.doc.resolve(a));if(!i)return-1;if(n=="right")return i.pos;const l=S.get(i.node(-1)),c=i.start(-1),d=l.map.indexOf(i.pos-c);return d%l.width==0?-1:c+l.map[d-1]}function is(t,e,n){const o=e.clientX-t.startX;return Math.max(n,t.startWidth+o)}function Ma(t,e){t.dispatch(t.state.tr.setMeta(V,{setHandle:e}))}function qc(t,e,n){const o=t.state.doc.resolve(e),r=o.node(-1),s=S.get(r),a=o.start(-1),i=s.colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1,l=t.state.tr;for(let c=0;c<s.height;c++){const d=c*s.width+i;if(c&&s.map[d]==s.map[d-s.width])continue;const u=s.map[d],p=r.nodeAt(u).attrs,m=p.colspan==1?0:i-s.colCount(u);if(p.colwidth&&p.colwidth[m]==n)continue;const f=p.colwidth?p.colwidth.slice():Uc(p.colspan);f[m]=n,l.setNodeMarkup(a+u,null,{...p,colwidth:f})}l.docChanged&&t.dispatch(l)}function ls(t,e,n,o){const r=t.state.doc.resolve(e),s=r.node(-1),a=r.start(-1),i=S.get(s).colCount(r.pos-a)+r.nodeAfter.attrs.colspan-1;let l=t.domAtPos(r.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&xo(s,l.firstChild,l,o,i,n)}function Uc(t){return Array(t).fill(0)}function Jc(t,e){var n;const o=[],r=t.doc.resolve(e),s=r.node(-1);if(!s)return rt.empty;const a=S.get(s),i=r.start(-1),l=a.colCount(r.pos-i)+r.nodeAfter.attrs.colspan-1;for(let c=0;c<a.height;c++){const d=l+c*a.width;if((l==a.width-1||a.map[d]!=a.map[d+1])&&(c==0||a.map[d]!=a.map[d-a.width])){const u=a.map[d],p=i+u+s.nodeAt(u).nodeSize-1,m=document.createElement("div");m.className="column-resize-handle",(n=V.getState(t))!=null&&n.dragging&&o.push(ot.node(i+u,i+u+s.nodeAt(u).nodeSize,{class:"column-resize-dragging"})),o.push(ot.widget(p,m))}}return rt.create(t.doc,o)}function Gc({allowTableNodeSelection:t=!1}={}){return new W({key:Me,state:{init(){return null},apply(e,n){const o=e.getMeta(Me);if(o!=null)return o==-1?null:o;if(n==null||!e.docChanged)return n;const{deleted:r,pos:s}=e.mapping.mapResult(n);return r?null:s}},props:{decorations:hc,handleDOMEvents:{mousedown:Pc},createSelectionBetween(e){return Me.getState(e.state)!=null?e.state.selection:null},handleTripleClick:Lc,handleKeyDown:Oc,handlePaste:Dc},appendTransaction(e,n,o){return gc(o,wc(o,n),t)}})}var Bn=typeof navigator<"u"?navigator:null,Sr=Bn&&Bn.userAgent||"",Xc=/Edge\/(\d+)/.exec(Sr),Yc=/MSIE \d/.exec(Sr),Qc=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Sr),Zc=!!(Yc||Qc||Xc),ed=!Zc&&!!Bn&&/Apple Computer/.test(Bn.vendor),$a=new P("safari-ime-span"),vo=!1,td={key:$a,props:{decorations:nd,handleDOMEvents:{compositionstart:()=>{vo=!0},compositionend:()=>{vo=!1}}}};function nd(t){const{$from:e,$to:n,to:o}=t.selection;if(vo&&e.sameParent(n)){const r=ot.widget(o,od,{ignoreSelection:!0,key:"safari-ime-span"});return rt.create(t.doc,[r])}}function od(t){const e=t.dom.ownerDocument.createElement("span");return e.className="ProseMirror-safari-ime-span",e}var rd=new W(ed?td:{key:$a});const sd={};function ad(t){const e=this,n=t||sd,o=e.data(),r=o.micromarkExtensions||(o.micromarkExtensions=[]),s=o.fromMarkdownExtensions||(o.fromMarkdownExtensions=[]),a=o.toMarkdownExtensions||(o.toMarkdownExtensions=[]);r.push(Ri(n)),s.push(_i()),a.push(Ei(n))}function k(t,e){return Object.assign(t,{meta:{package:"@milkdown/preset-gfm",...e}}),t}const Ar=qt("strike_through");k(Ar,{displayName:"Attr<strikethrough>",group:"Strikethrough"});const Qt=Vt("strike_through",t=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>e==="line-through"}],toDOM:e=>["del",t.get(Ar.key)(e)],parseMarkdown:{match:e=>e.type==="delete",runner:(e,n,o)=>{e.openMark(o),e.next(n.children),e.closeMark(o)}},toMarkdown:{match:e=>e.type.name==="strike_through",runner:(e,n)=>{e.withMark(n,"delete")}}}));k(Qt.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"});k(Qt.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});const Ir=N("ToggleStrikeThrough",t=>()=>Fn(Qt.type(t)));k(Ir,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});const xa=F(t=>Kt(/~([^~]+)~$/,Qt.type(t)));k(xa,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});const Tr=j("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:t=>{const e=t.get(v);return()=>e.call(Ir.key)}}});k(Tr.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"});k(Tr.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});const Zt=ic({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:t=>t.style.textAlign||"left",setDOMAttr:(t,e)=>{e.style=`text-align: ${t||"left"}`}}}}),ut=O("table",()=>({...Zt.table,content:"table_header_row table_row+",disableDropCursor:!0,parseMarkdown:{match:t=>t.type==="table",runner:(t,e,n)=>{const o=e.align,r=e.children.map((s,a)=>({...s,align:o,isHeader:a===0}));t.openNode(n),t.next(r),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table",runner:(t,e)=>{var n;const o=(n=e.content.firstChild)==null?void 0:n.content;if(!o)return;const r=[];o.forEach(s=>{r.push(s.attrs.alignment)}),t.openNode("table",void 0,{align:r}),t.next(e.content),t.closeNode()}}}));k(ut.node,{displayName:"NodeSchema<table>",group:"Table"});k(ut.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});const qn=O("table_header_row",()=>({...Zt.table_row,disableDropCursor:!0,content:"(table_header)*",parseDOM:[{tag:"tr[data-is-header]"}],toDOM(){return["tr",{"data-is-header":!0},0]},parseMarkdown:{match:t=>!!(t.type==="tableRow"&&t.isHeader),runner:(t,e,n)=>{const o=e.align,r=e.children.map((s,a)=>({...s,align:o[a],isHeader:e.isHeader}));t.openNode(n),t.next(r),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table_header_row",runner:(t,e)=>{t.openNode("tableRow",void 0,{isHeader:!0}),t.next(e.content),t.closeNode()}}}));k(qn.node,{displayName:"NodeSchema<tableHeaderRow>",group:"Table"});k(qn.ctx,{displayName:"NodeSchemaCtx<tableHeaderRow>",group:"Table"});const en=O("table_row",()=>({...Zt.table_row,disableDropCursor:!0,content:"(table_cell)*",parseMarkdown:{match:t=>t.type==="tableRow",runner:(t,e,n)=>{const o=e.align,r=e.children.map((s,a)=>({...s,align:o[a]}));t.openNode(n),t.next(r),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table_row",runner:(t,e)=>{t.openNode("tableRow"),t.next(e.content),t.closeNode()}}}));k(en.node,{displayName:"NodeSchema<tableRow>",group:"Table"});k(en.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});const tn=O("table_cell",()=>({...Zt.table_cell,disableDropCursor:!0,parseMarkdown:{match:t=>t.type==="tableCell"&&!t.isHeader,runner:(t,e,n)=>{const o=e.align;t.openNode(n,{alignment:o}).openNode(t.schema.nodes.paragraph).next(e.children).closeNode().closeNode()}},toMarkdown:{match:t=>t.type.name==="table_cell",runner:(t,e)=>{t.openNode("tableCell").next(e.content).closeNode()}}}));k(tn.node,{displayName:"NodeSchema<tableCell>",group:"Table"});k(tn.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});const Un=O("table_header",()=>({...Zt.table_header,disableDropCursor:!0,parseMarkdown:{match:t=>t.type==="tableCell"&&!!t.isHeader,runner:(t,e,n)=>{const o=e.align;t.openNode(n,{alignment:o}),t.openNode(t.schema.nodes.paragraph),t.next(e.children),t.closeNode(),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table_header",runner:(t,e)=>{t.openNode("tableCell"),t.next(e.content),t.closeNode()}}}));k(Un.node,{displayName:"NodeSchema<tableHeader>",group:"Table"});k(Un.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});function va(t,e=3,n=3){const o=Array(n).fill(0).map(()=>tn.type(t).createAndFill()),r=Array(n).fill(0).map(()=>Un.type(t).createAndFill()),s=Array(e).fill(0).map((a,i)=>i===0?qn.type(t).create(null,r):en.type(t).create(null,o));return ut.type(t).create(null,s)}function nn(t){return Ro(e=>e.type.spec.tableRole==="table")(t)}function Xe(t,e){const n=nn(e.$from);if(!n)return;const o=S.get(n.node);if(!(t<0||t>=o.width))return o.cellsInRect({left:t,right:t+1,top:0,bottom:o.height}).map(r=>{const s=n.node.nodeAt(r);if(!s)return;const a=r+n.start;return{pos:a,start:a+1,node:s}}).filter(r=>r!=null)}function Ye(t,e){const n=nn(e.$from);if(!n)return;const o=S.get(n.node);if(!(t<0||t>=o.height))return o.cellsInRect({left:0,right:o.width,top:t,bottom:t+1}).map(r=>{const s=n.node.nodeAt(r);if(!s)return;const a=r+n.start;return{pos:a,start:a+1,node:s}}).filter(r=>r!=null)}function id(t){const e=nn(t.$from);if(!e)return;const n=S.get(e.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map(o=>{const r=e.node.nodeAt(o),s=o+e.start;return{pos:s,start:s+1,node:r}})}function ld(t){const e=id(t.selection);if(e&&e[0]){const n=t.doc.resolve(e[0].pos),o=e[e.length-1];if(o){const r=t.doc.resolve(o.pos);return zn(t.setSelection(new I(r,n)))}}return t}function Sa(t,e,{map:n,tableStart:o,table:r},s){const a=Array(s).fill(0).reduce((l,c,d)=>l+r.child(d).nodeSize,o),i=Array(n.width).fill(0).map((l,c)=>{const d=r.nodeAt(n.map[c]);return tn.type(t).createAndFill({alignment:d==null?void 0:d.attrs.alignment})});return e.insert(a,en.type(t).create(null,i)),e}function Aa(t){return(e,n)=>o=>{n=n??o.selection.from;const r=o.doc.resolve(n),s=Ro(l=>l.type.name==="table")(r),a=s?{node:s.node,from:s.start}:void 0,i=t==="row";if(a){const l=S.get(a.node);if(e>=0&&e<(i?l.height:l.width)){const c=l.positionAt(i?e:l.height-1,i?l.width-1:e,a.node),d=o.doc.resolve(a.from+c),u=i?I.rowSelection:I.colSelection,p=l.positionAt(i?e:0,i?0:e,a.node),m=o.doc.resolve(a.from+p);return zn(o.setSelection(u(d,m)))}}return o}}const cd=Aa("row"),dd=Aa("col");function cs(t){return t[0].map((e,n)=>t.map(o=>o[n]))}function Ia(t,e){const n=[],o=S.get(t);for(let r=0;r<o.height;r++){const s=t.child(r),a=[];for(let i=0;i<o.width;i++){if(!e[r][i])continue;const l=o.map[r*o.width+i],c=e[r][i],d=t.nodeAt(l).type.createChecked(Object.assign({},c.attrs),c.content,c.marks);a.push(d)}n.push(s.type.createChecked(s.attrs,a,s.marks))}return t.type.createChecked(t.attrs,n,t.marks)}function Ta(t){const e=S.get(t),n=[];for(let o=0;o<e.height;o++){const r=[],s={};for(let a=0;a<e.width;a++){const i=e.map[o*e.width+a],l=t.nodeAt(i),c=e.findCell(i);if(s[i]||c.top!==o){r.push(null);continue}s[i]=!0,r.push(l)}n.push(r)}return n}function Ra(t,e,n,o){const r=e[0]>n[0]?-1:1,s=t.splice(e[0],e.length),a=s.length%2===0?1:0;let i;return i=r===-1?n[0]:n[n.length-1]-a,t.splice(i,0,...s),t}function ud(t,e,n,o){let r=cs(Ta(t.node));return r=Ra(r,e,n),r=cs(r),Ia(t.node,r)}function pd(t,e,n,o){let r=Ta(t.node);return r=Ra(r,e,n),Ia(t.node,r)}function ds(t,e){let n=t,o=t;for(let d=t;d>=0;d--){const u=Xe(d,e.selection);u&&u.forEach(p=>{const m=p.node.attrs.colspan+d-1;m>=n&&(n=d),m>o&&(o=m)})}for(let d=t;d<=o;d++){const u=Xe(d,e.selection);u&&u.forEach(p=>{const m=p.node.attrs.colspan+d-1;p.node.attrs.colspan>1&&m>o&&(o=m)})}const r=[];for(let d=n;d<=o;d++){const u=Xe(d,e.selection);u&&u.length&&r.push(d)}n=r[0],o=r[r.length-1];const s=Xe(n,e.selection),a=Ye(0,e.selection),i=e.doc.resolve(s[s.length-1].pos);let l;for(let d=o;d>=n;d--){const u=Xe(d,e.selection);if(u&&u.length){for(let p=a.length-1;p>=0;p--)if(a[p].pos===u[0].pos){l=u[0];break}if(l)break}}const c=e.doc.resolve(l.pos);return{$anchor:i,$head:c,indexes:r}}function us(t,e){let n=t,o=t;for(let d=t;d>=0;d--)Ye(d,e.selection).forEach(u=>{const p=u.node.attrs.rowspan+d-1;p>=n&&(n=d),p>o&&(o=p)});for(let d=t;d<=o;d++)Ye(d,e.selection).forEach(u=>{const p=u.node.attrs.rowspan+d-1;u.node.attrs.rowspan>1&&p>o&&(o=p)});const r=[];for(let d=n;d<=o;d++){const u=Ye(d,e.selection);u&&u.length&&r.push(d)}n=r[0],o=r[r.length-1];const s=Ye(n,e.selection),a=Xe(0,e.selection),i=e.doc.resolve(s[s.length-1].pos);let l;for(let d=o;d>=n;d--){const u=Ye(d,e.selection);if(u&&u.length){for(let p=a.length-1;p>=0;p--)if(a[p].pos===u[0].pos){l=u[0];break}if(l)break}}const c=e.doc.resolve(l.pos);return{$anchor:i,$head:c,indexes:r}}function hd(t){const{tr:e,origin:n,target:o,select:r=!0,pos:s}=t,a=s!=null?e.doc.resolve(s):e.selection.$from,i=nn(a);if(!i)return e;const{indexes:l}=ds(n,e),{indexes:c}=ds(o,e);if(l.includes(o))return e;const d=ud(i,l,c),u=zn(e).replaceWith(i.pos,i.pos+i.node.nodeSize,d);if(!r)return u;const p=S.get(d),m=i.start,f=o,w=p.positionAt(p.height-1,f,d),C=u.doc.resolve(m+w),b=I.colSelection,D=p.positionAt(0,f,d),_=u.doc.resolve(m+D);return u.setSelection(b(C,_))}function md(t){const{tr:e,origin:n,target:o,select:r=!0,pos:s}=t,a=s!=null?e.doc.resolve(s):e.selection.$from,i=nn(a);if(!i)return e;const{indexes:l}=us(n,e),{indexes:c}=us(o,e);if(l.includes(o))return e;const d=pd(i,l,c),u=zn(e).replaceWith(i.pos,i.pos+i.node.nodeSize,d);if(!r)return u;const p=S.get(d),m=i.start,f=o,w=p.positionAt(f,p.width-1,d),C=u.doc.resolve(m+w),b=I.rowSelection,D=p.positionAt(f,0,d),_=u.doc.resolve(m+D);return u.setSelection(b(C,_))}const Rr=N("GoToPrevTableCell",()=>()=>Ca(-1));k(Rr,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});const _r=N("GoToNextTableCell",()=>()=>Ca(1));k(_r,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});const Er=N("ExitTable",t=>()=>(e,n)=>{if(!Q(e))return!1;const{$head:o}=e.selection,r=$l(o,ut.type(t));if(!r)return!1;const{to:s}=r,a=e.tr.replaceWith(s,s,Te.type(t).createAndFill());return a.setSelection(K.near(a.doc.resolve(s),1)).scrollIntoView(),n==null||n(a),!0});k(Er,{displayName:"Command<breakTableCommand>",group:"Table"});const _a=N("InsertTable",t=>({row:e,col:n}={})=>(o,r)=>{const{selection:s,tr:a}=o,{from:i}=s,l=va(t,e,n),c=a.replaceSelectionWith(l),d=K.findFrom(c.doc.resolve(i),1,!0);return d&&c.setSelection(d),r==null||r(c),!0});k(_a,{displayName:"Command<insertTableCommand>",group:"Table"});const Ea=N("MoveRow",()=>({from:t,to:e,pos:n}={})=>(o,r)=>{const{tr:s}=o;return!!(r!=null&&r(md({tr:s,origin:t??0,target:e??0,pos:n,select:!0})))});k(Ea,{displayName:"Command<moveRowCommand>",group:"Table"});const Oa=N("MoveCol",()=>({from:t,to:e,pos:n}={})=>(o,r)=>{const{tr:s}=o;return!!(r!=null&&r(hd({tr:s,origin:t??0,target:e??0,pos:n,select:!0})))});k(Oa,{displayName:"Command<moveColCommand>",group:"Table"});const La=N("SelectRow",()=>(t={index:0})=>(e,n)=>{const{tr:o}=e;return!!(n!=null&&n(cd(t.index,t.pos)(o)))});k(La,{displayName:"Command<selectRowCommand>",group:"Table"});const Da=N("SelectCol",()=>(t={index:0})=>(e,n)=>{const{tr:o}=e;return!!(n!=null&&n(dd(t.index,t.pos)(o)))});k(Da,{displayName:"Command<selectColCommand>",group:"Table"});const Pa=N("SelectTable",()=>()=>(t,e)=>{const{tr:n}=t;return!!(e!=null&&e(ld(n)))});k(Pa,{displayName:"Command<selectTableCommand>",group:"Table"});const Wa=N("DeleteSelectedCells",()=>()=>(t,e)=>{const{selection:n}=t;if(!(n instanceof I))return!1;const o=n.isRowSelection(),r=n.isColSelection();return o&&r?Ic(t,e):r?Mc(t,e):xc(t,e)});k(Wa,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});const Ba=N("AddColBefore",()=>()=>bc);k(Ba,{displayName:"Command<addColBeforeCommand>",group:"Table"});const Ha=N("AddColAfter",()=>()=>Cc);k(Ha,{displayName:"Command<addColAfterCommand>",group:"Table"});const Fa=N("AddRowBefore",t=>()=>(e,n)=>{if(!Q(e))return!1;if(n){const o=Re(e);n(Sa(t,e.tr,o,o.top))}return!0});k(Fa,{displayName:"Command<addRowBeforeCommand>",group:"Table"});const ja=N("AddRowAfter",t=>()=>(e,n)=>{if(!Q(e))return!1;if(n){const o=Re(e);n(Sa(t,e.tr,o,o.bottom))}return!0});k(ja,{displayName:"Command<addRowAfterCommand>",group:"Table"});const za=N("SetAlign",()=>(t="left")=>vc("alignment",t));k(za,{displayName:"Command<setAlignCommand>",group:"Table"});const Ka=F(t=>new H(/^\|(?<col>\d+)[xX](?<row>\d+)\|\s$/,(e,n,o,r)=>{var s,a;const i=e.doc.resolve(o);if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),ut.type(t)))return null;const l=va(t,Number((s=n.groups)==null?void 0:s.row),Number((a=n.groups)==null?void 0:a.col)),c=e.tr.replaceRangeWith(o,r,l);return c.setSelection(q.create(c.doc,o+3)).scrollIntoView()}));k(Ka,{displayName:"InputRule<insertTableInputRule>",group:"Table"});const Or=j("tableKeymap",{NextCell:{shortcuts:["Mod-]","Tab"],command:t=>{const e=t.get(v);return()=>e.call(_r.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:t=>{const e=t.get(v);return()=>e.call(Rr.key)}},ExitTable:{shortcuts:["Mod-Enter"],command:t=>{const e=t.get(v);return()=>e.call(Er.key)}}});k(Or.ctx,{displayName:"KeymapCtx<table>",group:"Table"});k(Or.shortcuts,{displayName:"Keymap<table>",group:"Table"});const io="footnote_definition",ps="footnoteDefinition",Lr=O("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:""}},parseDOM:[{tag:`dl[data-type="${io}"]`,getAttrs:t=>{if(!(t instanceof HTMLElement))throw ue(t);return{label:t.dataset.label}},contentElement:"dd"}],toDOM:t=>{const e=t.attrs.label;return["dl",{"data-label":e,"data-type":io},["dt",e],["dd",0]]},parseMarkdown:{match:({type:t})=>t===ps,runner:(t,e,n)=>{t.openNode(n,{label:e.label}).next(e.children).closeNode()}},toMarkdown:{match:t=>t.type.name===io,runner:(t,e)=>{t.openNode(ps,void 0,{label:e.attrs.label,identifier:e.attrs.label}).next(e.content).closeNode()}}}));k(Lr.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"});k(Lr.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});const lo="footnote_reference",Dr=O("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:""}},parseDOM:[{tag:`sup[data-type="${lo}"]`,getAttrs:t=>{if(!(t instanceof HTMLElement))throw ue(t);return{label:t.dataset.label}}}],toDOM:t=>{const e=t.attrs.label;return["sup",{"data-label":e,"data-type":lo},e]},parseMarkdown:{match:({type:t})=>t==="footnoteReference",runner:(t,e,n)=>{t.addNode(n,{label:e.label})}},toMarkdown:{match:t=>t.type.name===lo,runner:(t,e)=>{t.addNode("footnoteReference",void 0,void 0,{label:e.attrs.label,identifier:e.attrs.label})}}}));k(Dr.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"});k(Dr.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});const Va=de.extendSchema(t=>e=>{const n=t(e);return{...n,attrs:{...n.attrs,checked:{default:null}},parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:o=>{if(!(o instanceof HTMLElement))throw ue(o);return{label:o.dataset.label,listType:o.dataset.listType,spread:o.dataset.spread,checked:o.dataset.checked?o.dataset.checked==="true":null}}},...(n==null?void 0:n.parseDOM)||[]],toDOM:o=>n.toDOM&&o.attrs.checked==null?n.toDOM(o):["li",{"data-item-type":"task","data-label":o.attrs.label,"data-list-type":o.attrs.listType,"data-spread":o.attrs.spread,"data-checked":o.attrs.checked},0],parseMarkdown:{match:({type:o})=>o==="listItem",runner:(o,r,s)=>{if(r.checked==null){n.parseMarkdown.runner(o,r,s);return}const a=r.label!=null?`${r.label}.`:"•",i=r.checked!=null?!!r.checked:null,l=r.label!=null?"ordered":"bullet",c=r.spread!=null?`${r.spread}`:"true";o.openNode(s,{label:a,listType:l,spread:c,checked:i}),o.next(r.children),o.closeNode()}},toMarkdown:{match:o=>o.type.name==="list_item",runner:(o,r)=>{if(r.attrs.checked==null){n.toMarkdown.runner(o,r);return}const s=r.attrs.label,a=r.attrs.listType,i=r.attrs.spread==="true",l=r.attrs.checked;o.openNode("listItem",void 0,{label:s,listType:a,spread:i,checked:l}),o.next(r.content),o.closeNode()}}}});k(Va,{displayName:"NodeSchema<listItem>",group:"ListItem"});const qa=F(()=>new H(/^\[(?<checked>\s|x)\]\s$/,(t,e,n,o)=>{var r;const s=t.doc.resolve(n);let a=0,i=s.node(a);for(;i&&i.type.name!=="list_item";)a--,i=s.node(a);if(!i||i.attrs.checked!=null)return null;const l=((r=e.groups)==null?void 0:r.checked)==="x",c=s.before(a),d=t.tr;return d.deleteRange(n,o).setNodeMarkup(c,void 0,{...i.attrs,checked:l}),d}));k(qa,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});const fd=[Tr,Or].flat(),gd=[Ka,qa],yd=[xa],Ua=Y(()=>rd);k(Ua,{displayName:"Prose<autoInsertSpanPlugin>",group:"Prose"});const wd=Y(()=>Bc({}));k(wd,{displayName:"Prose<columnResizingPlugin>",group:"Prose"});const Ja=Y(()=>Gc({allowTableNodeSelection:!0}));k(Ja,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});const Pr=at("remarkGFM",()=>ad);k(Pr.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"});k(Pr.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});const kd=new P("MILKDOWN_KEEP_TABLE_ALIGN_PLUGIN");function bd(t,e){let n=0;return e.forEach((o,r,s)=>{o===t&&(n=s)}),n}const Ga=Y(()=>new W({key:kd,appendTransaction:(t,e,n)=>{let o;const r=(s,a)=>{if(o||(o=n.tr),s.type.name!=="table_cell")return;const i=n.doc.resolve(a),l=i.node(i.depth),c=i.node(i.depth-1).firstChild;if(!c)return;const d=bd(s,l),u=c.maybeChild(d);if(!u)return;const p=u.attrs.alignment,m=s.attrs.alignment;p!==m&&o.setNodeMarkup(a,void 0,{...s.attrs,alignment:p})};return e.doc!==n.doc&&n.doc.descendants(r),o}}));k(Ga,{displayName:"Prose<keepTableAlignPlugin>",group:"Prose"});const Cd=[Ga,Ua,Pr,Ja].flat(),Nd=[Va,ut,qn,en,Un,tn,Lr,Dr,Ar,Qt].flat(),Md=[_r,Rr,Er,_a,Ea,Oa,La,Da,Pa,Wa,Fa,ja,Ba,Ha,za,Ir],$d=[Nd,gd,yd,fd,Md,Cd].flat();function pt(t,e){return Object.assign(t,{meta:{package:"@milkdown/plugin-history",...e}}),t}const Wr=N("Undo",()=>()=>xi);pt(Wr,{displayName:"Command<undo>"});const Br=N("Redo",()=>()=>vi);pt(Br,{displayName:"Command<redo>"});const Hr=ne({},"historyProviderConfig");pt(Hr,{displayName:"Ctx<historyProviderConfig>"});const Xa=Y(t=>Si(t.get(Hr.key)));pt(Xa,{displayName:"Ctx<historyProviderPlugin>"});const Fr=j("historyKeymap",{Undo:{shortcuts:"Mod-z",command:t=>{const e=t.get(v);return()=>e.call(Wr.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:t=>{const e=t.get(v);return()=>e.call(Br.key)}}});pt(Fr.ctx,{displayName:"KeymapCtx<history>"});pt(Fr.shortcuts,{displayName:"Keymap<history>"});const xd=[Hr,Xa,Fr,Wr,Br].flat();function vd(t,e){const{doc:n,selection:o}=t;if(!n||!o||!(o instanceof q||o instanceof Ai))return t;const{to:r}=o,s=e.type==="space"?Array(e.size).fill(" ").join(""):"	";return t.insertText(s,r)}const Jn=ne({type:"space",size:2},"indentConfig");Jn.meta={package:"@milkdown/plugin-indent",displayName:"Ctx<indentConfig>"};const Ya=Us(t=>({Tab:(e,n)=>{const o=t.get(Jn.key),{tr:r}=e,s=vd(r,o);return s.docChanged?(n==null||n(s),!0):!1}}));Ya.meta={package:"@milkdown/plugin-indent",displayName:"Shortcut<indent>"};const Sd=[Jn,Ya];function So(t){if(!t)return!1;if(Array.isArray(t))return t.length>1?!1:So(t[0]);const e=t.content;return e?So(e):t.type==="text"}function Ad(t){if(t.content.childCount===1){const e=t.content.firstChild;if((e==null?void 0:e.type.name)==="text"&&e.marks.length===0)return e;if((e==null?void 0:e.type.name)==="paragraph"&&e.childCount===1){const n=e.firstChild;if((n==null?void 0:n.type.name)==="text"&&n.marks.length===0)return n}}return!1}const Qa=Y(t=>{const e=t.get(fe);t.update(Pt,o=>({...o,editable:o.editable??(()=>!0)}));const n=new P("MILKDOWN_CLIPBOARD");return new W({key:n,props:{handlePaste:(o,r)=>{var s,a;const i=t.get(Lt),l=(a=(s=o.props).editable)==null?void 0:a.call(s,o.state),{clipboardData:c}=r;if(!l||!c||o.state.selection.$from.node().type.spec.code)return!1;const d=c.getData("text/plain"),u=c.getData("vscode-editor-data");if(u){const b=JSON.parse(u),D=b==null?void 0:b.mode;if(d&&D){const{tr:_}=o.state,pe=xl("code_block",e);return _.replaceSelectionWith(pe.create({language:D})).setSelection(q.near(_.doc.resolve(Math.max(0,_.selection.from-2)))).insertText(d.replace(/\r\n?/g,`
`)),o.dispatch(_),!0}}const p=c.getData("text/html");if(p.length===0&&d.length===0)return!1;const m=fs.fromSchema(e);let f;if(p.length===0){const b=i(d);if(!b||typeof b=="string")return!1;f=Ii.fromSchema(e).serializeFragment(b.content)}else{const b=document.createElement("template");b.innerHTML=p,f=b.content.cloneNode(!0),b.remove()}const w=m.parseSlice(f),C=Ad(w);return C?(o.dispatch(o.state.tr.replaceSelectionWith(C,!0)),!0):(o.dispatch(o.state.tr.replaceSelection(w)),!0)},clipboardTextSerializer:o=>{const r=t.get(tt);if(So(o.content.toJSON()))return o.content.textBetween(0,o.content.size,`

`);const s=e.topNodeType.createAndFill(void 0,o.content);return s?r(s):""}}})});Qa.meta={displayName:"Prose<clipboard>",package:"@milkdown/plugin-clipboard"};const jr=ne({shouldAppend:t=>!(!t||["heading","paragraph"].includes(t.type.name)),getNode:t=>t.schema.nodes.paragraph.create()},"trailingConfig");jr.meta={package:"@milkdown/plugin-trailing",displayName:"Ctx<trailingConfig>"};const Za=Y(t=>{const e=new P("MILKDOWN_TRAILING"),{shouldAppend:n,getNode:o}=t.get(jr.key),r=new W({key:e,state:{init:(s,a)=>{const i=a.tr.doc.lastChild;return n(i,a)},apply:(s,a,i,l)=>{if(!s.docChanged)return a;const c=s.doc.lastChild;return n(c,l)}},appendTransaction:(s,a,i)=>{const{doc:l,tr:c}=i,d=o==null?void 0:o(i),u=r.getState(i),p=l.content.size;if(!(!u||!d))return c.insert(p,d)}});return r});Za.meta={package:"@milkdown/plugin-trailing",displayName:"Prose<trailing>"};const Id=[jr,Za];class ei{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=e=>(this.beforeMountedListeners.push(e),this),this.mounted=e=>(this.mountedListeners.push(e),this),this.updated=e=>(this.updatedListeners.push(e),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners}}markdownUpdated(e){return this.markdownUpdatedListeners.push(e),this}blur(e){return this.blurListeners.push(e),this}focus(e){return this.focusListeners.push(e),this}destroy(e){return this.destroyListeners.push(e),this}}const Hn=$(new ei,"listener"),Td=new P("MILKDOWN_LISTENER"),ti=t=>(t.inject(Hn,new ei),async()=>{await t.wait(We);const e=t.get(Hn),{listeners:n}=e;n.beforeMount.forEach(i=>i(t)),await t.wait(Dt);const o=t.get(tt);let r=null,s=null;const a=new W({key:Td,view:()=>({destroy:()=>{n.destroy.forEach(i=>i(t))}}),props:{handleDOMEvents:{focus:()=>(n.focus.forEach(i=>i(t)),!1),blur:()=>(n.blur.forEach(i=>i(t)),!1)}},state:{init:(i,l)=>{r=l.doc,s=o(l.doc)},apply:i=>!i.docChanged||i.getMeta("addToHistory")===!1?void 0:Oi(()=>{const{doc:l}=i;if(n.updated.length>0&&r&&!r.eq(l)&&n.updated.forEach(c=>{c(t,l,r)}),n.markdownUpdated.length>0&&r&&!r.eq(l)){const c=o(l);n.markdownUpdated.forEach(d=>{d(t,c,s)}),s=c}r=l},200)()}});t.update(ce,i=>i.concat(a)),await t.wait(An),n.mounted.forEach(i=>i(t))});ti.meta={package:"@milkdown/plugin-listener",displayName:"Listener"};var ni=(t=>(t.CodeMirror="code-mirror",t.ListItem="list-item",t.LinkTooltip="link-tooltip",t.Cursor="cursor",t.ImageBlock="image-block",t.BlockEdit="block-edit",t.Toolbar="toolbar",t.Placeholder="placeholder",t.Table="table",t.Latex="latex",t))(ni||{});const Rd={cursor:!0,"list-item":!0,"link-tooltip":!0,"image-block":!0,"block-edit":!0,placeholder:!0,toolbar:!0,"code-mirror":!0,table:!0,latex:!0};async function _d(t,e,n){switch(t){case"code-mirror":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-B3KiKTSt-D_Q87O6c.js");return{defineFeature:r}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]));return o(e,n)}case"list-item":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-Cuk7cL-r-D2buIkaX.js");return{defineFeature:r}},__vite__mapDeps([16,5,9,3,2,1,10,11,12,13,14,15]));return o(e,n)}case"link-tooltip":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-DcRgwPLd-P6ihpufO.js");return{defineFeature:r}},__vite__mapDeps([17,5,18,7,19,20,2,8,11,1,3,15,9,10,12,13,14]));return o(e,n)}case"image-block":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-BFsG6770-BZqzKW-r.js");return{defineFeature:r}},__vite__mapDeps([21,5,7,12,3,2,1,13,14,9,10,22,11,15]));return o(e,n)}case"cursor":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-CxJ9fxJm-Cyut1UQw.js");return{defineFeature:r}},__vite__mapDeps([23,24,11,1,2,3,12,13,14,15]));return o(e,n)}case"block-edit":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-Yr5XBaro-CuXjpj7M.js");return{defineFeature:r}},__vite__mapDeps([25,26,5,7,20,2,8,11,1,3,15,22,12,13,14,9,10]));return o(e,n)}case"placeholder":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-DOrkOhki-DKJnW9Rn.js");return{defineFeature:r}},__vite__mapDeps([27,26,11,1,2,3,12,13,14,15]));return o(e,n)}case"toolbar":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-COPjfgxB-8VHCRTXW.js");return{defineFeature:r}},__vite__mapDeps([28,26,5,9,3,2,1,10,29,12,13,14,19,20,8,11,18,7,15]));return o(e,n)}case"table":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-CBrOT1fW-BEd5UIat.js");return{defineFeature:r}},__vite__mapDeps([30,5,7,9,3,2,1,10,20,8,11,12,13,14,15]));return o(e,n)}case"latex":{const{defineFeature:o}=await se(async()=>{const{defineFeature:r}=await import("./index-DO_xaFxN-BEzCla_i.js");return{defineFeature:r}},__vite__mapDeps([31,12,3,2,1,13,14,29,26,5,6,7,8,9,10,11,19,20,15]));return o(e,n)}}}const Ed=$([],"FeaturesCtx"),Od=$({},"CrepeCtx");function Ld(t){return e=>{e.inject(Ed,t)}}var oi=t=>{throw TypeError(t)},ri=(t,e,n)=>e.has(t)||oi("Cannot "+n),J=(t,e,n)=>(ri(t,e,"read from private field"),n?n.call(t):e.get(t)),an=(t,e,n)=>e.has(t)?oi("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),ln=(t,e,n,o)=>(ri(t,e,"write to private field"),e.set(t,n),n),ee,_t,Dn,Pn;class si{constructor({root:e,features:n={},featureConfigs:o={},defaultValue:r=""}){an(this,ee),an(this,_t),an(this,Dn),an(this,Pn,!0);var s;const a=Object.entries({...Rd,...n}).filter(([,l])=>l).map(([l])=>l);ln(this,Dn,(s=typeof e=="string"?document.querySelector(e):e)!=null?s:document.body),ln(this,ee,Pl.make().config(l=>{l.inject(Od,this)}).config(Ld(a)).config(l=>{l.set(In,J(this,Dn)),l.set(vn,r),l.set(Pt,{editable:()=>J(this,Pn)}),l.update(Jn.key,c=>({...c,size:4}))}).use(nc).use(ti).use(xd).use(Sd).use(Id).use(Qa).use($d));const i=[];a.forEach(l=>{const c=o[l];i.push(_d(l,J(this,ee),c))}),ln(this,_t,Promise.all(i))}async create(){return await J(this,_t),J(this,ee).create()}async destroy(){return await J(this,_t),J(this,ee).destroy()}get editor(){return J(this,ee)}setReadonly(e){return ln(this,Pn,!e),this}getMarkdown(){return J(this,ee).action(Bl())}on(e){return J(this,ee).status!==Vs.Created?(J(this,ee).config(n=>{const o=n.get(Hn);e(o)}),this):(J(this,ee).action(n=>{const o=n.get(Hn);e(o)}),this)}}ee=new WeakMap;_t=new WeakMap;Dn=new WeakMap;Pn=new WeakMap;si.Feature=ni;const Dd=()=>{const t=Xn.useRef(null),e=Xn.useRef(void 0);return Xn.useEffect(()=>(e.current=new si({root:t.current,defaultValue:"Hello, Milkdown!"}),e.current.create().then(n=>{n.onStatusChange(o=>{console.log(o)})}),()=>{var n;(n=e.current)==null||n.destroy()}),[]),ai.jsx("div",{ref:t,className:"h-dvh w-full"})},lu=Object.freeze(Object.defineProperty({__proto__:null,Component:Dd},Symbol.toStringTag,{value:"Module"}));export{Ut as $,Oa as A,nt as B,ni as C,Ea as D,nu as E,Ed as F,su as G,Te as H,Fe as I,Jt as J,Xt as K,Qe as L,de as M,ut as N,v as O,ct as P,dt as Q,it as R,ue as S,Qt as T,va as U,lu as V,Gt as W,Ml as a,Ho as b,ou as c,Ss as d,I as e,O as f,nn as g,ne as h,ja as i,Fa as j,at as k,iu as l,Ha as m,Po as n,F as o,ru as p,Ba as q,Wa as r,za as s,Oo as t,Y as u,lt as v,Da as w,xe as x,La as y,Ir as z};
